{% extends 'base.html' %}
{% block content %}
{% load static %}
{% load tz %}
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" /> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> -->
<!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.13.3/css/selectize.default.min.css"
rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.13.3/js/standalone/selectize.min.js"></script>  -->


<!-- <link rel="stylesheet" href="{% static 'assets/css/style.css' %}"> -->
<!-- <link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.15.2/css/selectize.default.min.css"
  integrity="sha512-pTaEn+6gF1IeWv3W1+7X7eM60TFu/agjgoHmYhAfLEU8Phuf6JKiiE8YmsNC0aCgQv4192s4Vai8YZ6VNM6vyQ=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
/>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.15.2/js/selectize.min.js"
  integrity="sha512-IOebNkvA/HZjMM7MxL0NYeLYEalloZ8ckak+NDtOViP7oiYzG5vn6WVXyrJDiJPhl4yRdmNAG49iuLmhkUdVsQ=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
></script> -->

<style>
  .modal{
    z-index: 9999;
    overflow: scroll;
  }
    input[type=text], textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 4px;
      resize: vertical;
    }
    
    label {
      padding: 12px 12px 12px 0;
      display: inline-block;
    }
    
    
    .row:after {
      content: "";
      display: table;
      clear: both;
    }
    
    @media screen and (max-width: 600px) {
      .col-25, .col-75, input[type=submit] {
        width: 100%;
        margin-top: 0;
      }
      input[type=text], select, textarea {
      width: 100%;

    }
    }

    .dropdown input,
    .dropdown button {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
    }

    .dropdown.open input,
    .dropdown.open button {
      display: block;
    }

    .row a{
      color: rgb(218, 164, 48);
      font-size: 12px;
    }

    .table th a{
      color:rgb(218, 164, 48);
      font-size: 11px;
      margin-left: 60px;
    }


    ::-webkit-scrollbar {
      width: 5px; 
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1; 
    }

    ::-webkit-scrollbar-thumb {
      background: #888; 
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #555; 
    }
    .fields {
      display: none;
    }
    .selectize-input {
    /* height: 6vh; */
    /* border: #000000 1px solid; */
    /* border-radius: 5px; */
    width: 100%;
    /* color: #000000; */
    font-size: 1rem;
    color: rgb(0, 0, 0);
  }

    </style>

  <script>
  //   $(document).ready(function() {
  //     console.log("Loaded Selectize");
  // $('#cars').selectize({
  // sortField: 'value',
  // render: {
  //  item: function (item, escape) {
  //    if (item.value === '') {
  //      return '';
  //    }
  //    return '<div>' + escape(item.text) + '</div>';
  //  }
  // }
  // });
  // });
  </script>
  <!-- <div class="row">
<select name="carss" id="cars">
<option value="volvo">Volvo</option>
<option value="saab">Saab</option>
<option value="mercedes">Mercedes</option>
<option value="audi">Audi</option>
</select>
</div>  -->

<div class="container-fulid ">

  <div class=" radius-15" style="width: 100%;">
    <div class="card-body">
        <div class="card-title">
          <h2 class="mb-0 text-uppercase text-right">Edit  Vendor Credits </h2>
        </div>
    </div>
  </div>
  <div>
  <div class=" radius-15 p-2">
    <form action="{% url 'change_vendor_credits' po.id %}" class="mt-2 mb-4" method="post" enctype="multipart/form-data">
      {% csrf_token %}
      
      <div class="row">
        <div class="col-md-3">
          <label>Vendor Name *</label>
        </div>
        <div class="col-md-6 d-flex">
          <select name="vendor" id="vendor" class="form-control bg-light text-dark"  >
            <option selected value="{{po.vendor_name}}">{{po.vendor_name.split.0}} {{po.vendor_name.split.1}}</option>
            {% for v in vendor %}
            <option value="{{ v.first_name }} {{ v.last_name }} {{v.id}}">{{ v.first_name }} {{ v.last_name }}</option>
            {% endfor %}
          </select>
          <a class="text-center ms-1" href="" data-toggle="modal" data-target="#newvendor"><i
            class="fa-solid fs-5 fa fa-plus rounded pt-2"
            style="color: white; background-color: rgb(210, 132, 30);height: 6.4vh;width: 6.4vh;padding: 0.5rem;"></i></a>
  
          <!-- <a href="" data-toggle="modal" data-target="#newvendor">+ Add New Vendor</a> -->
        </div>
        
      </div>


      <div class="row mt-2 " id="email_row">
        <div class="col-md-3">
          <label for="email_inp">Vendor Email</label>
        </div>
        <div class="col-md-6">
          <input type="text" class="form-control bg-light text-dark" id="email_inp" value="{{po.vendor_email}}" name="email_inp">
        </div>
      </div>

      <div class="row mt-2 " id="gst_trt_row">
        <div class="col-md-3">
          <label for="gst_trt_inp">GST Treatment</label>
        </div>
        <div class="col-md-6">
          <input type="text" class="form-control bg-light text-dark" value="{{po.gst_treatment}}" id="gst_trt_inp" name="gst_trt_inp">
        </div>
      </div>

      <div class="row mt-2 mb-2 " id="gstin_row">
        <div class="col-md-3">
          <label for="gstin_inp">GST Number</label>
        </div>
        <div class="col-md-6">
          <input type="text" class="form-control bg-light text-dark" value="{{po.gst_number}}"  id="gstin_inp" name="gstin_inp">
        </div>
      </div>

      <div class="row mt-2 mb-2" id="address_row">
        <div class="col-md-3">
          <label for="address_inp">Address </label>
        </div>
        <div class="col-md-6">
          <input type="text" class="form-control bg-light text-dark" value="{{po.address}}" id="address_inp" name="address_inp">
        </div>
      </div>



      <!-- <div class="row mt-2  " id="">
        <div class="col-md-3 ">
          <label for="">Deliver To</label>
        </div>
        <script>
          function showFields() {
            var organizationSelected = document.getElementById("organization").checked;
            var customerSelected = document.getElementById("customer").checked;
            
            var organizationFields = document.getElementById("organizationFields");
            var customerFields = document.getElementById("customerFields");
            
            organizationFields.style.display = organizationSelected ? "block" : "none";
            customerFields.style.display = customerSelected ? "block" : "none";
          }
        </script> -->

        <!-- <div class="col-md-3">
          <input type="radio"  name="option" value="Organization"  id="organization" onclick="showFields()"> Organization
        </div>
        <div class="col-md-3">
          <input type="radio" name="option" value="Customer" id="customer" onclick="showFields()"> Customer
        </div>
      </div>

      <div id="organizationFields" class="fields">
        <h3>Organization Details:</h3> -->
<!-- <div class="row">
  <div class="col-md-3">
    <label for="orgName">Name:</label>
  
  </div>       
  <div class="col-md-6">
    <input type="text" id="orgName" class="form-control bg-light text-dark" name="orgName">
  </div>
</div>
<div class="row mt-2">
  <div class="col-md-3">
    <label for="gstNumber">GST Number:</label>
  
  </div>        
  <div class="col-md-6">
    <input type="text" class="form-control bg-light text-dark" id="gstNumber" name="gstNumber">
  </div> 
</div>     
<div class="row mt-2">
  <div class="col-md-3">
    <label for="orgAddress">E-Mail:</label>
  
  </div>       
  <div class="col-md-6">
    <input type="text" placeholder="sample@gmail.com" class="form-control bg-light text-dark" id="orgMail" name="orgMail">
  </div>
</div>
<br>
<div class="row mt-2">
  <div class="col-md-3">
    <label for="orgAddress">Address:</label>
  
  </div>       
  <div class="col-md-6">
    <input type="text" class="form-control bg-light text-dark" id="orgAddress" name="orgAddress">
  </div>
</div>
<br>
<div class="row">
  <div class="col-md-3">
    <label for="custAddress">Streat:</label>

  </div>
  <div class="col-md-6">
    <input class="form-controlbg-light text-dark" type="text"  name="orgStreat">

  </div>

</div>
<br>
<div class="row">
  <div class="col-md-3">
    <label for="custAddress">City:</label>

  </div>
  <div class="col-md-6">
    <input class="form-controlbg-light text-dark" type="text"  name="orgcity">

  </div>

</div>
<br>
<div class="row">
  <div class="col-md-3">
    <label for="custAddress">State:</label>

  </div>
  <div class="col-md-6">
    <input class="form-controlbg-light text-dark" type="text"  name="orgstate">

  </div>

</div>

    </div>
      
      <div id="customerFields" class="fields">
        <h3>Customer Details:</h3>
        <div class="row mt-2">
          <div class="col-md-3">
            <label style="color: rgb(190, 88, 88);">Customer Name *</label><br>
          </div>
          <div class="col-md-6">
            <select name="custom" id="custom" class="form-control bg-light text-dark" >
              <option value=""></option>
              {% for c in customer %}
              <option value="{{ c.customerName }} ">{{ c.customerName }}</option>
              {% endfor %}
            </select>
            <a href="" data-toggle="modal" data-target="#newcustomer">+ Add New Customer</a>
            <input type="hidden" id="cust_state" value="" readonly >
  
            <input type="hidden" id="company_state" value="{{company.state}}" readonly>
  
          </div>
        </div> -->

        <!-- <div class="row">
          <div class="col-md-3">
            <label for="custName">Email:</label>

          </div>
          <div class="col-md-6">
            <input type="text" id="cemail_inp" class="form-control bg-light text-dark" name="custMail">
          </div>
        </div>
        <div class="row">
          <div class="col-md-3">
            <label for="custAddress">Address:</label>

          </div>
          <div class="col-md-6">
            <input class="form-controlbg-light text-dark" type="text" id="custAddress" name="custAddress">

          </div>

        </div>
        <br>
        <div class="row">
          <div class="col-md-3">
            <label for="custAddress">Streat:</label>

          </div>
          <div class="col-md-6">
            <input class="form-controlbg-light text-dark" type="text" id="custstreet" name="custStreet">
  
          </div>

        </div>
<br>
        <div class="row">
          <div class="col-md-3">
            <label for="custAddress">City:</label>

          </div>
          <div class="col-md-6">
            <input class="form-controlbg-light text-dark" type="text" id="custcity" name="custcity">
  
          </div>

        </div>
        <br>
        <div class="row">
          <div class="col-md-3">
            <label for="custAddress">State:</label>

          </div>
          <div class="col-md-6">
            <input class="form-controlbg-light text-dark" type="text" id="custstate" name="custstate">
  
          </div>

        </div> -->
        
       
 

<!-- 
      </div> -->



      <div class="row mt-5 mb-5">
        <div class="col-md-3">
          <label>Source of Supply*</label>
        </div>

        <div class="col-md-6">
            <select name="srcofsupply" id="srcofsupply" onclick="toggleDateInput()" onselect="calculateTaxAmount()" class="form-control bg-light text-dark">
              <option selected value="{{po.source_supply}}">{{po.source_supply}}</option>
              <option value="[AN]-Andaman And Nicobar Islands">[AN]-Andaman And Nicobar Islands</option> <option value="[AD]-Andhra Pradesh">[AD]-Andhra Pradesh</option>
              <option value="[AR]-Arunachal Pradesh">[AR]-Arunachal Pradesh	</option> <option value="volvo">[AS]-Assam</option>
              <option value="[BR]-Bihar">[BR]-Bihar</option> <option value="volvo">[CH]-	Chandhigarh</option><option value="[CG]-Chattisgarh">[CG]-Chattisgarh</option>
              <option value="[DD]-Daman Diu">[DD]-Daman Diu</option><option value="volvo">[DL]-	Delhi</option><option value="[GA]-Goa">[GA]-Goa</option> <option value="[GJ]-Gujarat">[GJ]-Gujarat</option>
              <option value="[HR]-Haryana">[HR]-Haryana</option> <option value="[HP]-Himachal Pradesh">[HP]-Himachal Pradesh</option>
              <option value="[JK]-Jammu And Kashmir">[JK]-Jammu And Kashmir</option><option value="[JH]-Jharkand">[JH]-Jharkand</option>
              <option value="[KA]-Karnataka">[KA]-Karnataka</option><option value="[KL]-Kerala">[KL]-Kerala</option>
              <option value="[LA]-Ladakh">[LA]-Ladakh</option><option value="[LD]-Lakshadweep">[LD]-Lakshadweep</option>
              <option value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option><option value="[MH]-Maharashtra">[MH]-Maharashtra</option>
              <option value="[MN]-Manipur">[MN]-Manipur</option>  <option value="[ML]-Meghalaya">[ML]-Meghalaya</option>
            <option value="[MZ]-Mizoram">[MZ]-Mizoram</option> <option value="[NL]-Nagaland">[NL]-Nagaland</option> <option value="[NL]-Nagaland">[NL]-Nagaland</option>
             <option value="[OD]-Odisha">[OD]-Odisha</option><option value="[PY]-Puducherry">[PY]-Puducherry</option>
              <option value="[PB]-Punjab">[PB]-Punjab.</option><option value="[RL]-Rajasthan">[RL]-Rajasthan</option>
              <option value="[SK]-Sikkim">[SK]-Sikkim</option><option value="[TN]-Tamilnadu">[TN]-Tamilnadu</option>
              <option value="[TS]-Telenghana">[TS]-Telenghana</option><option value="[TR]-Tripura">[TR]-Tripura</option><option value="[UP]-Uttar Pradesh">[UP]-Uttar Pradesh</option>
              <option value="[UK]-Utharakhand">[UK]-Utharakhand</option><option value="[WB]-West Bengal">[WB]-West Bengal</option>
              <option value="[OT]-Other Territory">[OT]-Other Territory</option>
            </select>
            
        </div>
      </div>
      
      

      <div class="row mt-3 mb-2">
        <div class="col-md-3">
          <label for="credit_note">Credit Note *</label>
        </div>

        <div class="col-md-6">
          <input type="text" class="form-control text-dark bg-light" value="{{po.credit_note}}" id="credit_note" name="credit_note" value="DUS-" maxlength="8" required>
        </div>
      </div>

      <div class="row mt-3 mb-2">
        <div class="col-md-3">
          <label for="order_number">Reference Number *</label>
        </div>

        <div class="col-md-6">
          <input type="text" class="form-control text-dark bg-light" value="{{po.order_no}}"  id="order_number" name="order_number" required>
        </div>
      </div>

      <div class="row mt-2" >
        <div class="col-md-3">
          <label for="date1">Vendor Credit Date</label>
        </div>
        <div class="col-md-3">
          <input type="date" class="form-control text-dark bg-light" value="{{po.vendor_date |date:'Y-m-d' }}"  id="credit_date" name="credit_date" required>
        </div>
    </div>
    <div class="row mt-2" >
      <div class="col-md-3">
        <label for="date1">Bill Number</label>
      </div>
      <div class="col-md-6">
        <select class="form-control text-dark bg-light" name="billno" id="billno">
          <option selected value="{{po.bill_number}}">{{po.bill_number}}</option>
        </select>
      </div>
  </div>
  <div class="row mt-2" >
    <div class="col-md-3">
      <label for="date1">Payment Methode</label>
    </div>
    <div class="col-md-6">
      <select class="form-control text-dark bg-light" name="pay_method" id="pay_method">
        <option value="{{po.payment_methode}}">{{po.payment_methode}}</option>
        <option value="Cash">Cash</option>
        <option value="UPI">UPI</option>
        <option value="Cheque">Cheque</option>
        {% for i in bnk %}
        <option value="{{i.id}}">{{i.name}}</option>
        {% endfor %}
      </select>
    </div>
</div>
<div class="row mt-2" id="upi" style="display: none;">
  <div class="col-md-3">
    <label for="date1">UPI</label>
  </div>
  <div class="col-md-6">
    <input type="text" class="form-control text-dark bg-light" name="upiid" id="upiid">
  </div>
</div>
<div class="row mt-2" id="cheque" style="display: none;">
  <div class="col-md-3">
    <label for="date1">Cheque Number</label>
  </div>
  <div class="col-md-6">
    <input type="text" class="form-control text-dark bg-light" name="chequeno" id="chequeno">
  </div>
</div>
<div class="row mt-2" id="bnk" style="display: none;">
  <div class="col-md-3">
    <label for="date1">Account Number</label>
  </div>
  <div class="col-md-6">
    <input type="text" class="form-control text-dark bg-light" name="accountno" id="accountno">
  </div>
</div>


      



  
      <div class="row mt-2">
        <div class="col-md-12 table-responsive-md mt-3">
          <table class="table table-bordered " style="width: 103%;" id="item_table" onclick='toggleDateInput()'>
            <thead>
              <tr>
                <th>Sl no</th>
                <th>Item<br><a href="" data-toggle="modal" data-target="#newitem" class="text-capitalize">+ Item</a></th>
                <!-- <th class="text-uppercase">account<br><a href="" data-toggle="modal" data-target="#newaccount" class="text-capitalize">+ NEW</a></th> -->
                <th class="text-right">Hsn</th>
                <th class="text-right">Quantity</th>
                <th class="text-right">Rate</th>
                <th class="text-right">Discount</th>
                <th class="text-right">Tax</th>
                <th class="text-right">Amount</th>
              </tr>
            </thead>
            <tbody>
              {% for i in po_table %}
              <tr id="row1{{forloop.counter}}">
                <td class="text-center">{{forloop.counter}}</td>
                  <td style="width: 5%;">
                      <div ><select
                        class='form-control bg-light text-dark  border-0 item_select itm'
                        name='item[]' id='item{{forloop.counter}}'>
                        <option value="{{i.item}}">{{i.item}}</option>
                              {% for i in item %}
                                <option value="{{i.Name}}">{{ i.Name  }} </option>
                              {% endfor %}
                          </select></div>
                  </td>
                  
                  <!-- <td  style="width: 13%;">
                    <div class="d-flex">
                      <select name='account[]' id="account1" class="form-control acnt bg-light text-dark">
                        <option value=" " selected disabled >Select Account</option>
                        <optgroup class=""label="Accounts Payable">
                          <option value='Accounts Payable'>Accounts Payable</option>
                        </optgroup>
    
                        <optgroup class="" label="Accounts Receivable">
                          <option value='Accounts Receivable'>Accounts Receivable</option>
                        </optgroup>
  
                        <optgroup class="" label="Other Current Asset">
                          <option value='Advance Tax'>Advance Tax</option>
                          <option value='Employee Advance'>Employee Advance</option>
                          <option value='Prepaid Expences'>Prepaid Expences</option>
                          <option value='GST TCS Receivable'>GST TCS Receivable</option>
                          <option value='GST TDS Receivable'>GST TDS Receivable</option>
                          <option value='Input Tax Credits'>Input Tax Credits</option>
                          <option value='Input CGST'>Input CGST</option>
                          <option value='Input IGST'>Input IGST</option>
                          <option value='Input SGST'>Input SGST</option>
                          <option value='Reverse Charge Input Tax but not Due'>Reverse Charge Input Tax but not Due</option>
                          <option value='Sales to Customers(Cash)'>Sales to Customers(Cash)</option>
                          <option value='TDS Receivable'>TDS Receivable</option>
                        </optgroup>
  
                        <optgroup class="" label="Expence">
                          <option value='Advertising and Marketing'>Advertising and Marketing</option>
                          <option value='Automobile Expense'>Automobile Expense</option>
                          <option value='Bad Debt'>Bad Debt</option>
                          <option value='Bank Fees and Charges'>Bank Fees and Charges</option>
                          <option value='Consultant Expense'>Consultant Expense</option>
                          <option value='Credit Card Expense'>Credit Card Expense</option>
                          <option value='IT and Internet Expenses'>IT and Internet Expenses</option>
                          <option value='Janitorial Expences'>Janitorial Expences</option>
                          <option value='Lodging'>Lodging</option>
                          <option value='Meals and Entertainment'>Meals and Entertainment</option>
                          <option value='Office Supplies'>Office Supplies</option>
                          <option value=0>Other Expenses</option>
                          <option value='Other Expenses'>Postage</option>
                          <option value='Printing and Stationery'>Printing and Stationery</option>
                          <option value='Rent Expense'>Rent Expense</option>
                          <option value='Repair and Maintenance'>Repair and Maintenance</option>
                          <option value='Salaries and Employee Wages'>Salaries and Employee Wages</option>
                          <option value='Telephone Expense'>Telephone Expense</option>
                          <option value='Travel Expense'>Travel Expense</option>
                          <option value='Uncategorized'>Uncategorized</option>
                          <option value='Contract Assets'>Contract Assets</option>
                          <option value='Depreciation and Amortisation'>Depreciation and Amortisation</option>
                          <option value='Merchandise'>Merchandise</option>
                          <option value='Raw Materials and Consumables'>Raw Materials and Consumables</option>
                          <option value='Transpotaion Expense'>Transpotaion Expense</option>
                        </optgroup>
  
                        <optgroup class="" label="Cost of Goods Sold">
                          <option value='Cost of Goods Sold'>Cost of Goods Sold</option>
                          <option value='Job Costing'>Job Costing</option>
                          <option value='Labor'>Labor</option>
                          <option value='Materials'>Materials</option>
                          <option value='Subcontractor'>Subcontractor</option>
                        </optgroup>
  
                        <optgroup class="" label="Income">
                          <option value='Discount'>Discount</option>
                          <option value='General Income'>General Income</option>
                          <option value='Interest Income'>Interest Income</option>
                          <option value='Late Fee Income'>Late Fee Income</option>
                          <option value='Other Charges'>Other Charges</option>
                          <option value='Sales'>Sales</option>
                          <option value='Shipping Charge'>Shipping Charge</option>
                        </optgroup>
  
                        <optgroup class="" label="Equity">
                          <option value='Drawings'>Drawings</option>
                          <option value='Opening Balance Offset'>Opening Balance Offset</option>
                          <option value="Owner's Equity">Owner's Equity</option>
                          <option value='Retained Earnings'>Retained Earnings</option>
                          <option value='Capital Stock'>Capital Stock</option>
                          <option value='Distributions'>Distributions</option>
                          <option value='Dividends Paid'>Dividends Paid</option>
                          <option value='Investments'>Investments</option>
                        </optgroup>
  
                        <optgroup class="" label="Other Current Liability">
                          <option value='Employee Reimbursements'>Employee Reimbursements</option>
                          <option value='Opening Balance Adjustments'>Opening Balance Adjustments</option>
                          <option value='Tax Payable'>Tax Payable</option>
                          <option value='Unearned Revenue'>Unearned Revenue</option>
                          <option value='GST Payable'>GST Payable</option>
                          <option value='Output CGST'>Output CGST</option>
                          <option value='Output IGST'>Output IGST</option>
                          <option value='Output SGST'>Output SGST</option>
                          <option value='TDS Payable'>TDS Payable</option>
                        </optgroup>
  
                        <optgroup class="" label="Other Expense">
                          <option value='Exchange Gain or Loss'>Exchange Gain or Loss</option>
                        </optgroup>
  
                        <optgroup class="" label="Fixed Asset">
                          <option value='Furniture and Equipment'>Furniture and Equipment</option>
                        </optgroup>
  
                        <optgroup class="" label="Stock">
                          <option value='Inventory Asset'>Inventory Asset</option>
                        </optgroup>
  
                        <optgroup class="" label="Cash">
                          <option value='Petty Cash'>Petty Cash</option>
                          <option value='Undeposited Funds'>Undeposited Funds</option>
                        </optgroup>
  
                        <optgroup class="" label="Other Liability">
                          <option value='Tag Adjustments'>Tag Adjustments</option>
                        </optgroup>
  
                        <optgroup class="" label="Long Term Liability">
                          <option value='Construction Loans'>Construction Loans</option>
                          <option value='Mortgages'>Mortgages</option>
                        </optgroup>
  
                        <optgroup class="" label="Others">
                          {% for i in account %}
                            <option value="{{ i.id }}">{{ i.accountName }} </option>
                          {% endfor %}
                        </optgroup>
                        
                        <hr>
                        {% for i in account %}
                            <option value="{{ i.accountName }} ">{{ i.accountName  }} </option>
                        {% endfor %}
                      </select>
                    </div>  
                  </td> -->

                  <td style="width: 13%;" class='text-right'><input type='number' id='hsn{{forloop.counter}}'
                    class=' text-right hsn form-control bg-light text-dark px-0' name='hsn[]' value="{{i.hsn}}">
            </td>
                  <td style="width: 9%;" class='text-right'><input type='number' id='qty{{forloop.counter}}'
                          class=' text-right qty form-control bg-light text-dark' name='quantity[]'
                          value='{{i.quantity}}'>
                          <input type='number' id='maxqty{{forloop.counter}}' 
                          class=' text-right maxqty form-control bg-light text-dark' name='maxqty[]'
                          value='0' style="display: none;">
                  </td>
                  <td style="width: 10%;" class='text-right'><input type='number' id='rate{{forloop.counter}}'
                          class=' text-right rate form-control bg-light text-dark px-0' name='rate[]'
                          value='{{i.rate}}'>
                  </td>
                  <td style="width: 9%;" class='text-right text-dark'><input type='number' id='discount{{forloop.counter}}'
                          class=' text-right discount bg-light text-dark form-control' name='discount[]'
                          value='{{i.discount}}'>
                  </td>
                  <td style="width: 12%;" class='text-right '> <select name='tax[]' id='tax{{forloop.counter}}'
                          class='form-control bg-light text-dark  text-right border-0 tax px-0' onclick="toggleDateInput()">
                          {% if i.PO.source_supply == "{{company.state}}" %}
                          <option value="{{i.tax}} ">{{i.tax}}  GST</option>
                            {% else %}
                            <option value="{{i.tax}} ">{{i.tax}} IGST</option>
                            {% endif %}
                          <optgroup class="text-center" label="GST">
                            <option value="0">0% GST(0%)</option>
                            <option value="3">3.0% GST(3%)</option>
                            <option value="5">5.0% GST(5%)</option>
                            <option value="12">12.0% GST(12%)</option>
                            <option value="18">18.0% GST(18%)</option>
                            <option value="28">28.0% GST(28%)</option>
                          </optgroup>
                          <optgroup  class="text-center" label="IGST">
                            <option value="0">0% IGST(0%)</option>
                            <option value="3">3.0% IGST(3%)</option>
                            <option value="5">5.0% IGST(5%)</option>
                            <option value="12">12.0% IGST(12%)</option>
                            <option value="18">18.0% IGST(18%)</option>
                            <option value="28">28.0% IGST(28%)</option>             
                            </optgroup>
                      </select></td>
                  <td style="display: none;">
                      <input type="text" name='taxamount' id="taxamount{{forloop.counter}}"
                          class=" taxamount text-dark" />
                  </td>
                  <td style="width: 15%;" class='text-right'><input type='number' id='amount{{forloop.counter}}'
                          class=' text-right form-control amount bg-light text-dark' name='amount[]'
                          value='0.00'></td>
                  <td class='text-center'>
  <button type='button' id='del_btn{{forloop.counter}}'
          class='btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-row'
          style='width:30px'>X</button>
  <button type='button' class='btn btn-transparent text-primary btn-sm btn-outline-primary rounded-circle clone-row' data-row=1 style='width:30px'><i class="fa fa-clone"></i>
  </button>
</td>

 </tr>
 {%endfor%}
      </tbody>
    </table>
    <button type="button" class="btn btn-sm text-white" style="background-color: rgb(210, 132, 30);" id="add-row">Add another line</button>
  </div>
</div>

      <div class="row border-bottom pb-5">
        <div class="col-sm-5 d-flex flex-column mt-auto">

            <label for="">Vendors Credit Note</label>
            <textarea name="customer_note" id="" cols="8" rows="8"
                placeholder=" Vendor Credit Notes"></textarea>
        </div>
        <div class="col-sm-6 " >
            <table class=" table  text-white" style="background-color: rgba(58, 57, 57, 0.8);">
                <tr>
                    <td>Sub Total</td>
                    <td></td>
                    <td><input type="number" id="subtotal" name="subtotal" step="any" value="0.00"
                            class="bg-transparent border-0 text-right subtotal text-white"></td>
                </tr>
                <tr style="display: none;" id="tr_igst">
                    <td>IGST</td>
                    <td></td>
                    <td><input type="number" id='igst' name="igst" step="any" value="0.00"
                            class="form-control bg-transparent border-0 text-right igst  text-white" ></td>
                </tr>
                <tr style="display: none;" id="tr_cgst">
                    <td>CGST</td>
                    <td></td>
                    <td><input type="number" id='cgst' name="cgst" step="any" value="0.00"
                            class="form-control bg-transparent border-0 text-right cgst text-white" ></td>
                </tr>
                <tr style="display: none;" id="tr_sgst">
                    <td>SGST</td>
                    <td></td>
                    <td><input type="number" id='sgst' name="sgst" step="any" value="0.00"
                            class="form-control bg-transparent border-0 text-right sgst  text-white" ></td>
                </tr>
                <tr>
                    <td>Tax Amount</td>
                    <td></td>
                    <td><input type="number" id="total_taxamount" name="total_taxamount" step="any" value="0.00" 
                        class="total_taxamount form-control bg-transparent border-0 text-right  text-white"></td>
                </tr>
                 <tr>
                    <td>Shipping Charges</td>
                    
                    <td><input type="hidden" id="shipping_charge"  step="any" value="0.00" 
                        class="form-control bg-transparent border-0 text-right shipping_charge  "></td>
                        <td><input type="number" name="shipping_charge" class="form-control  bg-transparent border-0  text-light" id="shipping" value="{{po.shipping_charge}}"> </td>
                </tr>
                <tr>
                  <td>Adjustment </td>
                  
                  <td><input type="hidden" id="adjustment" name="adjustment" step="any" value="0.00" 
                      class="form-control bg-transparent border-0 text-right adjustment  "></td>
                      <td><input type="number" class="form-control  bg-transparent border-0  text-light" id="shipping" step="any" value="0"> </td>
              </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td> </td>
                </tr>
                <tr>
                    <th>Total ( &#x20B9; )</th>
                    <th></th>
                    <th><input type="number" id="grandtotal" name="grandtotal" step="any" value="{{po.grand_total}}" 
                            class="form-control bg-transparent border-0 text-right grandtotal  text-white"></th>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td> </td>
                </tr>
                <tr>
                  <td>Paid </td>
                  <td></td>
                  <td>
                    <input type="number" id="paid" name="paid" step="any" value='{{po.paid}}' 
                            class="form-control bg-transparent border-0 text-right paid  text-white">
                             </td>
              </tr>
              <tr>
                  <th>Balance </th>
                  <td></td>
                  <th>
                    <input type="number" id="balance" name="balance" step="any" value='{{po.balance}}' 
                            class="form-control bg-transparent border-0 text-right balance  text-white">
                             </th>
              </tr>
            </table>
        </div>
    </div>

    <div class="row py-5 border-bottom">
        <!-- <div class="col-md-8 d-flex flex-column w-60 text-white">
            <label for="">Terms & Conditions</label>
            <textarea name="tearms_conditions" id="" cols="20" rows="5"
                placeholder=" Enter the terms & conditions of your business to be displayed in your transaction."></textarea>
        </div> -->
        <div class="col-md-4 py-5 text-center rounded" style="background-color: rgba(32, 35, 37);">
            <label class="text-white" for="">Attach File(s) to Purchase</label><br>

            
            <input id="file-upload" class="form-control bg-light text-dark" type="file" name="file">



        </div>
    </div>
    <div class="row mt-5 mb-3">
      <center>
        <input type="submit" class="btn save_btn text-align-center font-weight-bold mt-2" 
                style="width: 200px; text-align: center ;" value="SAVE CHANGES" id="save">
      </center>
      
    </div>
    </form>
    <div class="modal fade" id="newvendor">
      <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
          <div class="modal-header " style="background: rgb(32, 35, 37);">
              <h3 class="m-3 text-uppercase">New Vendor</h3>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>
          <div class="modal-body" style="background: rgb(32, 35, 37);">
            <div class="card p-3 m-3">
              <form action="{% url 'vendor_credit_vendor'  %}" method="post" class="needs-validation" novalidate autocomplete="off" id="modalVendor">
                {% csrf_token %}
                <div class=" form-group row">
                  <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                      <label >Primary Contact</label>
                  </div>
                  <div class="col-sm-12 col-md-1 col-lg-1" style="width: 5.5rem;">
                      <select id="select1"  name="salutation" class="form-control bg-light text-dark  " >
                        
                       
                          <option value="Mr">Mr</option>
                          <option value="Mrs">Mrs</option>
                          <option value="Ms">Ms</option>
                          <option value="Dr">Dr</option>
  
  
     
                          
                         </select> 
                  </div>
                  <div class="col-sm-12 col-md-2 col-lg-3" style="width:17rem;">
                      <input  type="text" class="form-control bg-light text-dark  " id="fname" name="first_name" placeholder="first name" required >
  
                  </div>
                  <div class="col-sm-12 col-md-2 col-lg-3" style="width:17rem;">
                      <input type="text" class="form-control bg-light text-dark " id="lname" name="last_name" placeholder="last name" required >
  
                  </div>
              </div>
  
                 <div class="form-group row mt-4">
                     <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Company Name</label></div>
                      <div class="col-sm-12 col-md-6 col-lg-6">
                          <input  type="text" class="form-control bg-light text-dark " name="company_name" required>     
                          <div class="invalid-feedback">Please fill out this field.</div>   
   
                      </div>
  
  
                  </div>
                  <div class="form-group row mt-4">
                      <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Vendor Display Name</label></div>
                       <div class="col-sm-12 col-md-6 col-lg-6">
                          
                              <select  name="v_display_name" class="form-control bg-light text-dark " onclick="vendor_display()">
                              <option id="select2"></option>
                                  
                              </select> 
            
                                  
                                
                       </div>
                       <script type="text/javascript">
                          function vendor_display()
                          {
                              var x=document.getElementById("select1").value;
                              var y=document.getElementById("fname").value;
                              var z=document.getElementById("lname").value;
  
                              document.getElementById("select2").innerHTML=x+" "+y+" "+z
                             
                              
                          }
                       </script>
   
   
                   </div>
  
                   <div class="form-group row mt-4">
                      <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Vendor Email</label></div>
                      <div class="col-sm-12 col-md-6 col-lg-6">
                           <input  type="email" class="form-control bg-light text-dark" name="vendor_email" required> 
                           <div class="invalid-feedback">Please fill out this field.</div>   
       
                       </div>
   
   
                   </div>
  
                   <!-- <div class="form-group row mt-4">
                      <label class="col-sm-12 col-md-3 col-lg-3 col-form-label">Vendor phone</label>
                       <div class="col-sm-12 col-md-3 col-lg-3">
                           <input  type="number" class="form-control bg-light text-dark" name="w_phone" placeholder="work phone" required>
                           <div class="invalid-feedback">Please fill out this field.</div>   
        
                       </div>
                       <div class=" col-sm-12 col-md-3 col-lg-3">
                          <input  type="number" class="form-control bg-light text-dark" name="m_phone" placeholder="mobile number" required>
                          <div class="invalid-feedback">Please fill out this field.</div>   
        
                      </div>
                      <div class="toggle1" style="color: rgb(230, 171, 45);font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                          <a href="">More Details</a>
  
                       </div>
   
   
                   </div> -->
                   <div class="form-group row mt-4">
                      <label class="col-sm-12 col-md-3 col-lg-3 col-form-label">Vendor phone</label>
                       <div class="col-sm-12 col-md-3 col-lg-3">
                           <input id="workphone"  type="text" class="form-control bg-light text-dark" pattern="[0-9]{7}"   name="w_phone" placeholder="work phone" required>
                           <label for="" id="workphone_label"></label>
                           <div class="invalid-feedback">Please fill out this field.</div>   
        
                       </div>
                       <div class=" col-sm-12 col-md-3 col-lg-3">
                          <input id="mphone"  type="text" pattern="[0-9]{10}" class="form-control bg-light text-dark" onclick="work_phone()"                        name="m_phone" placeholder="mobile number" required>
                          <label for="" id="mphone_label"></label>
                          <div class="invalid-feedback">Please fill out this field.</div>   
        
                      </div>
                      <div class="toggle1" style="color: rgb(230, 171, 45);font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                          <a href="">More Details</a>
  
                       </div>
   
   
                   </div>
                   
  
                   <fieldset1 id="more_detail" class="more details" style="display: none;">
  
  
                      <div class="form-group row mt-4">
                          <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Skype name/Number</label></div>
                         
                           <div class="col-sm-12 col-md-6 col-lg-6">
                             <input  type="text" class="form-control bg-light text-dark" name="skype_number">      
                           </div>
                           
       
       
                       </div>
  
  
                      <div class="form-group row mt-4">
                          <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Designation</label></div>
                          <div class="col-sm-12 col-md-6 col-lg-6">
                               <input  type="text" class="form-control bg-light text-dark" name="designation">      
                           </div>
       
       
                      </div>
                      <div class="form-group row mt-4">
                          <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Department</label></div>
                          <div class="col-sm-12 col-md-6 col-lg-6">
                               <input  type="text" class="form-control bg-light text-dark" name="department">      
                           </div>
       
       
                       </div>
  
                   </fieldset1>
  
                  <!-- <div class="form-group row mt-4">
                      <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Website</label></div>
                      <div class="col-sm-12 col-md-6 col-lg-6">
                           <input type="text" class="form-control bg-light text-dark" name="website" required>      
                      </div>
                  </div> -->
                  <div class="form-group row mt-4">
                      <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Website</label></div>
                      <div class="col-sm-12 col-md-6 col-lg-6">
                           <input id="web" type="text" class="form-control bg-light text-dark" onclick="mobile_phone()"    name="website" required>      
                      </div>
                  </div>
  
  
  
                  <br><br><span class="input-group mb-1 mt-3">
                      <div class="toggle2"
                        style="color: rgb(230, 171, 45);font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                        <a href="" style="color: rgb(230, 171, 45);">Other Details </a></div>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  
                      <div class="toggle3" style="color: rgb(230, 171, 45);font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                      
                        <a href="" style="color: rgb(230, 171, 45);">Address </a>
                        <!-- <button class="btn" onclick="fieldset5_function()" style="border: none;background-color: transparent;">Address</button> -->
                      </div>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  
                      <div class="toggle4"
                        style="color: rgb(230, 171, 45);;font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                        <a href="" style="color: rgb(230, 171, 45);">Contact Persons </a></div>
                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  
                      <!-- <div class="toggle6"
                        style="color: rgb(230, 171, 45);;font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                        Reporting Tags</div> -->
  
                      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                      <div class="toggle7"
                        style="color: rgb(230, 171, 45);;font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                        <a href="" style="color: rgb(230, 171, 45);">Remarks</a></div>
  
                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    </span><br><br><br>
  
                    <fieldset2 class="other details">
  
                      
  
                        <div class="form-group row mt-2">
                          <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > GST Treatment*</label>
                           
                          <div class=" col-sm-12 col-md-3 col-lg-3">
                              <select name="gst" id="GSTT" class="form-control bg-light text-dark" onclick="gstPan_function()">
                                  <option value="Select a Gst Treatment" selected>Select a Gst Treatment</option>
                                  <option value="Registered Business-Regular Business that is registered under GST">Registered Business-Regular Business that is registered under GST</option>
                                  <option value="Registered Business-Composition Business that is registered under the Composition scheme in GST">
                                      Registered Business-Composition Business that is registered under the Composition schemen in GST
                                  </option>
                                  <option value="Unregistered Business-not Registered under GST">Unregistered Business-not Registered under GST</option>
                                  <option value="Overseas- Persons with who you do import or exports of supplies outside india">Overseas- Persons with who you do import or exports of supplies outside india</option>
                                  <option value="Special Economic Zone">Special Economic Zone</option>
                              </select><br>
                          </div>
       
       
                      </div>
                      <fieldset3 id="gst" style="display: none;">
                          <div class="row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label"  > GSTIN/UIN*</label>
                               
                              <div class=" col-sm-12 col-md-3 col-lg-3">
                                  <input type="text" class="form-control bg-light text-dark" name="gst_number" id="gst_input" onmouseout="gst_check()"> 
                                  <label id="gst_label"></label>     
          
                              </div>
           
           
                          </div>
  
                      </fieldset3>
  
                      <fieldset4 id="pan" style="display: none;">
                          <div class=" row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > PAN</label>
                               
                              <div class=" col-sm-12 col-md-3 col-lg-3">
                                  <input type="text" class="form-control bg-light text-dark" id="pan_input" onmouseout="pan_check()" name="pan_number">  
                                  <label id="pan_label"></label>     
      
          
                              </div>
           
           
                          </div>
  
                      </fieldset4>
  
  
  
                      
  
                  <div class="form-group row mt-4">
                      <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Source Of Supply*</label>
                       
                      <div class=" col-sm-12 col-md-3 col-lg-3">
                          <select name="source_supply" id="source_supply" class="form-control bg-light text-dark">
                          <option value="value"></option>
                        <option value="[AN]-Andaman And Nicobar Islands">[AN]-Andaman And Nicobar Islands</option> <option value="[AD]-Andhra Pradesh">[AD]-Andhra Pradesh</option>
                        <option value="[AR]-Arunachal Pradesh">[AR]-Arunachal Pradesh	</option> <option value="volvo">[AS]-Assam</option>
                        <option value="[BR]-Bihar">[BR]-Bihar</option> <option value="volvo">[CH]-	Chandhigarh</option><option value="[CG]-Chattisgarh">[CG]-Chattisgarh</option>
                        <option value="[DD]-Daman Diu">[DD]-Daman Diu</option><option value="volvo">[DL]-	Delhi</option><option value="[GA]-Goa">[GA]-Goa</option> <option value="[GJ]-Gujarat">[GJ]-Gujarat</option>
                        <option value="[HR]-Haryana">[HR]-Haryana</option> <option value="[HP]-Himachal Pradesh">[HP]-Himachal Pradesh</option>
                        <option value="[JK]-Jammu And Kashmir">[JK]-Jammu And Kashmir</option><option value="[JH]-Jharkand">[JH]-Jharkand</option>
                        <option value="[KA]-Karnataka">[KA]-Karnataka</option><option value="[KL]-Kerala">[KL]-Kerala</option>
                        <option value="[LA]-Ladakh">[LA]-Ladakh</option><option value="[LD]-Lakshadweep">[LD]-Lakshadweep</option>
                        <option value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option><option value="[MH]-Maharashtra">[MH]-Maharashtra</option>
                        <option value="[MN]-Manipur">[MN]-Manipur</option>  <option value="[ML]-Meghalaya">[ML]-Meghalaya</option>
                      <option value="[MZ]-Mizoram">[MZ]-Mizoram</option> <option value="[NL]-Nagaland">[NL]-Nagaland</option> <option value="[NL]-Nagaland">[NL]-Nagaland</option>
                       <option value="[OD]-Odisha">[OD]-Odisha</option><option value="[PY]-Puducherry">[PY]-Puducherry</option>
                        <option value="[PB]-Punjab">[PB]-Punjab.</option><option value="[RL]-Rajasthan">[RL]-Rajasthan</option>
                        <option value="[SK]-Sikkim">[SK]-Sikkim</option><option value="[TN]-Tamilnadu">[TN]-Tamilnadu</option>
                        <option value="[TS]-Telenghana">[TS]-Telenghana</option><option value="[TR]-Tripura">[TR]-Tripura</option><option value="[UP]-Uttar Pradesh">[UP]-Uttar Pradesh</option>
                        <option value="[UK]-Utharakhand">[UK]-Utharakhand</option><option value="[WB]-West Bengal">[WB]-West Bengal</option>
                        <option value="[OT]-Other Territory">[OT]-Other Territory</option>
                            </select>
                      </div>
   
   
                  </div>
                  
  
  
  
                  <div class="form-group row mt-4">
                      <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Currency*</label>
                       
                      <div class=" col-sm-12 col-md-3 col-lg-3">
                          <select name="currency" id="PLACE" class="form-control bg-light text-dark">
                              <option value="Indian Rupee" selected>Indian Rupee</option>
                              <option value="Indian Rupee">Indian Rupee</option>
                    
                          </select>
                      </div>
   
   
                  </div>
  
                  <div class="form-group row">
                      <label class="col-sm-12 col-md-3 col-lg-3 col-form-label">Opening Balance Type</label>
                      <div class="col-sm-12 col-md-3 col-lg-3 d-flex align-items-center">
                          <div class="form-check form-check-inline">
                              <input class="form-check-input" type="radio" name="op_type" id="debit" value="debit">
                              <label class="form-check-label" for="debit">Debit</label>
                          </div>
                          <div class="form-check form-check-inline">
                              <input class="form-check-input" type="radio" name="op_type" id="credit" value="credit">
                              <label class="form-check-label" for="credit">Credit</label>
                          </div>
                      </div>
                  </div>
  
  
                  <div class="form-group row mt-4">
                      <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Opening Balance Amount</label>                    
                      <div class=" col-sm-12 col-md-3 col-lg-3">
                          <input  type="number" class="form-control bg-light text-dark" name="opening_bal">      
                      </div>
                  </div>
                  
                  
  
  
                  <div class="form-group row mt-4">
                      <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Payment Terms</label>
                       
                      <div class=" col-sm-12 col-md-3 col-lg-3">
                          <select name="payment_terms" id="PLACE" class="form-control bg-light text-dark">
                              <option value="NET 60" >NET 60</option>
                              <option value="NET 45" >NET 45</option>                          
                              <option value="NET 30">NET 30</option>
                              <option value="Due on Receipt" selected>Due on Receipt</option>
                              <option >
                                </option>
                          </select>
  
                      </div>
   
   
                  </div>
  
                  
  
              </fieldset2>
  <!-- ....................................   Fieldset 5  .................................................... -->
  
              <fieldset5 id="address" style="display: none;">
                  <div>
                      <div class="row">
                          <div class="col-sm-12 col-md-6 col-lg-6">
                              <div class="row">
                                  <div class="col-sm-12 col-md-6 col-lg-6">
                                      <label for="">BILLING ADDRESS</label>
                                  </div>
                                  <div class="col"></div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Attention</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="text" class="form-control bg-light text-dark" name="battention" id="batten">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Country</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <select name="bcountry" id="btry" class="form-control bg-light text-dark">
                                          <option value="India" selected>India</option>
                                      </select>      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Address</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <textarea class="form-control bg-light " style="border: none;color: rgb(7, 7, 7);" cols="26" rows="4" name="baddress" id="badd1"></textarea>
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > City</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="text" class="form-control bg-light text-dark" name="bcity" id="bcty">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > State</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input type="text" class="form-control bg-light text-dark" name="bstate" id="bste">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Zip Code </label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="number" class="form-control bg-light text-dark" name="bzip" id="bzp">      
                                  </div>
                              </div>
                              <!-- <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Phone </label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="number" class="form-control bg-light text-dark" name="bphone" id="bphn">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Fax </label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="number" class="form-control bg-light text-dark" name="bfax" id="bfx">      
                                  </div>
                              </div> -->
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Phone </label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input id="bphone_num"  type="tel" pattern="[0-9]{10}" class="form-control bg-light text-dark" name="bphone" >
                                      <label for="" id="bphone_label"></label>      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Fax </label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{7}" onmouseout="fax_number()"  onclick="bphone_number()"                                       name="bfax" id="bfx">  
                                     
                                      <label for="" id="fax_label"></label> 
                                  </div>
                              </div>
  
                          </div>
                          <div class="col-sm-12 col-md-6 col-lg-6">
                              <div class="row">
                                  <div class="col-sm-12 col-md-6 col-lg-6">
                                      <label for="">SHIPPING ADDRESS</label>
                                  </div>
                                  <div class="col-sm-12 col-md-6 col-lg-6">
                                      <input  type="checkbox" id="myCheckT" onclick="myCopyAddressFunction()">&nbsp;
                                      <label for="myCheck">Same as Billing Address:</label>
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Attention</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="text" class="form-control bg-light text-dark " style="color: white;" name="sattention" id="satten">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Country</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <select name="scountry" id="sctry" class="form-control bg-light text-dark">
                                          <option value="India" selected>India</option>
                                      </select>      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Address</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <textarea class="form-control bg-light" style="border: none;color: rgb(10, 10, 10);" id="sadd1" cols="26" rows="4" name="saddress"></textarea>
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > City</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="text" class="form-control bg-light text-dark" name="scity" id="scty">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > State</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input type="text" class="form-control bg-light text-dark" name="sstate" id="sste">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Zip Code </label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="number" class="form-control bg-light text-dark" name="szip" id="szp">      
                                  </div>
                              </div>
                              <!-- <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Phone </label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="number" class="form-control bg-light text-dark" name="sphone" id="sphn">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Fax </label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="number" class="form-control bg-light text-dark" name="sfax" id="sfx">      
                                  </div>
                              </div> -->
  
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Phone </label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{10}" style="color: white;" name="sphone" id="sphone_num">  
                                      <label for="" id="sphone_label"></label>    
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" > Fax </label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{7}" style="color: white;" name="sfax" onclick="sphone_number()" onmouseout="sfax_number()" id="sfx"> 
                                      <label for="" id="sfax_label"></label>     
                                  </div>
                              </div>
  
                          </div>
                      </div>
                  </div>
              </fieldset5>
  
              <fieldset6 id="contact_person" style="display: none;color: azure ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;" >
                  <div class="row">
                      <div class="col-sm-12 ">
                          
                              <table id="tbl" class="table text-white" style="background-color: rgba(250, 227, 198, 0.5);">
                                  <tr>
                                    <th>Salutation</th>
                                    <th>First Name</th>
                                    <th>Last Name</th>
                                    <th>Email Address</th>
                                    <th >Work Phone <br><label for="" id="twph_label"></label></th>
                                    <th >Mobile <br><label for="" id="tlabel"></label>    </th>
                                    <th >Skype Name/No</th>
                                    <th >Designation</th>
                                    <th >Department</th>
                                  </tr>
                                  <tr>
                                    <td><select name="salutation[]" class="bg-transparent border-0 text-white"  id="PLACE" >
                                      <option class="text-dark"  >Select</option>
                                        <option class="text-dark" value="Mr" >Mr.</option>
                                        <option class="text-dark" value="Mrs">Mrs.</option>
                                        <option class="text-dark" value="Ms">Ms.</option>
                                        <option class="text-dark" value="Miss">Miss.</option>
                                        <option class="text-dark" value="Dr">Dr.</option>
                                      </select></td>
                                    <td><input type="text" class=" form-control border-1 bg-transparent text-white"    name="first_name[]"  ></td>
                                    <td><input type="text"class="form-control border-1 bg-transparent text-white"  name="last_name[]" /></td>
                                    <td><input type="text" class="form-control border-1 bg-transparent text-white"  name="email[]" /></td>
                                    <!-- <td><input type="text" style="width:8rem;" name="wphone[]" /></td>
                                    <td><input type="text" style="width:8rem;" name="mobile[]" /></td>
                                    <td><input type="text" style="width:8rem;" name="skype[]" /></td> -->
                                    <td><input type="tel" pattern="[0-9]{7}" class="form-control border-1 bg-transparent text-white"  id="twphone" name="wphone[]"/></td>
                                    <td><input type="tel" pattern="[0-9]{10}"  class="form-control border-1 bg-transparent text-white"  id="tmobile" onclick="sample1()"   name="mobile[]" /></td>
                                    <td><input type="number" class="form-control border-1 bg-transparent text-white"  onclick="sample()" name="skype[]" /></td>
                                    <td><input type="text" class="form-control border-1 bg-transparent text-white"  name="designation[]" /></td>
                                    <td><input type="text" class="form-control border-1 bg-transparent text-white"  name="department[]" /></td>
                                  </tr>
                                </table>
                               
                          
                          <div class="button add_another mt-3"
                          style="color: rgb(230, 171, 45);;font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                          + Add Contact Person</div>
                            
                      </div>
                      
                  </div>
  
              </fieldset6>
  
  
  
   <!-- ...........................................................Remarks    ......................................... -->
  
  
  
              <fieldset7 class="remarks" style="display: none;">
                  <div class="row">
                      <div class="col-sm-12 col-md-8 col-lg-8">
                          <div class="form-group row mt-4">
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <textarea class="bg-light" style="border: none;color: rgb(5, 5, 5);" cols="70" rows="4" name="remark"></textarea>
                              </div>
                          </div>
                      </div>
                      <div class="col-sm-12 col-md-2 col-lg-2"></div>
                  </div>
  
              </fieldset7>
  
  
  
              
              
  
             
                <div class="row">
                  <div class="col-md-4"></div>
                  <div class="col-md-4">
                    <div class="d-flex">
                      <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                      type="submit" data-dismiss="modal" id="vendorSave">Submit
                      </button> 

                      <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                        data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">Cancel</span>
                      </button>
                    </div>
                  </div>
                  <div class="col-md-4"></div>
                </div>
              </form>
                  </div>
              </div>
              <script>
                function gstPan_function(){
                    var x=document.getElementById('GSTT').value
                    if(x=="Unregistered Business-not Registered under GST")
                    {
                        document.getElementById("pan").style.display="block";
                        document.getElementById("gst").style.display="none";
            
                        
                    }
                    else if((x=="Registered Business-Regular Business that is registered under GST") || (x=="Registered Business-Composition Business that is registered under the Composition scheme in GST") || (x=="Overseas- Persons with who you do import or exports of supplies outside india") || (x=="Special Economic Zone"))
                    {
                        document.getElementById("gst").style.display="block";
                        document.getElementById("pan").style.display="block";
            
            
                    }
                
                }
                function gst_check(){
                    var x=document.getElementById("gst_input").value;
                    var gst_label=document.getElementById("gst_label")
                    // var expr=/^[0-9]{15}$/;
                    var expr=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;
            
                    // "[0-9]{2}[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}[1-9A-Za-z]{1}[Z]{1}[0-9a-zA-Z]{1}"
                    // /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/
                    if (!expr.test(x)) {
                        gst_label.style.color="red";
                        gst_label.innerHTML = "Invalid GST Number.";
                    }
                    else{
                        gst_label.style.color="green";
            
                        gst_label.innerHTML = "valid GST Number.";
            
                    }
                }
                function pan_check(){
                    var x=document.getElementById("pan_input").value;
                    var gst_label=document.getElementById("pan_label")
                    var expr=    /^[A-Z]{5}[0-9]{4}[A-Z]{1}$/
                    if (!expr.test(x)) {
                        pan_label.style.color="red";
                        pan_label.innerHTML = "Invalid PAN Number.";
                    }
                    else{
                        pan_label.style.color="green";
            
                        pan_label.innerHTML = "valid PAN Number.";
            
                    }
                }
            
            
            
                $(document).ready(function () {
                    $(".toggle1").click(function (e) {
                      e.preventDefault();
                      $("fieldset1").toggle();
                    })
                  })
                  $(document).ready(function () {
                    $(".toggle2").click(function (e) {
                      e.preventDefault();
                     
                      $("fieldset2").toggle(); 
                      $("fieldset5").hide();
                      $("fieldset6").hide();
                      $("fieldset7").hide();
            
            
                  
                    })
                  })
            
                  $(document).ready(function () {
                    $(".toggle3").click(function (e) {
                      e.preventDefault();
                      $("fieldset5").toggle();
                      $("fieldset2").hide();
                      $("fieldset6").hide();
                      $("fieldset7").hide();
            
                    })
                  })
                  $(document).ready(function () {
                    $(".toggle4").click(function (e) {
                      e.preventDefault();
                      $("fieldset6").toggle();
                      $("fieldset2").hide();
                      $("fieldset5").hide();
                      $("fieldset7").hide();
                            
                    })
                  })
                  $(document).ready(function () {
                    $(".toggle7").click(function (e) {
                      e.preventDefault();
                      $("fieldset7").toggle();
                      $("fieldset2").hide();
                      $("fieldset6").hide();
                      $("fieldset5").hide();
                     
            
                     
                    })
                  })
            
             
            
              
            
               
            
                //   $('document').ready(function () {
                //     $('.add_another').click(function () {
                //       $("#tbl").append('<tr><td><select name="salutation[]" id="PLACE" style="width:8rem;height: 2.4rem;"><option value="Mr" selected>Mr.</option><option value=""Mrs">Mrs.</option><option value="Ms">Ms.</option><option value="Miss">Miss.</option><option value="Dr">Dr.</option></select>  </td><td><input type="text" name="first_name[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="last_name[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="email[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="wphone[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="mobile[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="skype[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="designation[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="department[]" style="width:8rem;" class="txtbox" value="" /></td></tr>');
                //     });
                //   })
            
                $('document').ready(function () {
                    $('.add_another').click(function () {
                      $("#tbl").append('<tr><td><select name="salutation[]" id="PLACE" class="bg-light" style="width:8rem;height:2.4rem;border: none;color: black;"><option value="Mr" selected>Mr.</option><option value=""Mrs">Mrs.</option><option value="Ms">Ms.</option><option value="Miss">Miss.</option><option value="Dr">Dr.</option></select>  </td><td><input type="text" name="first_name[]" class="bg-light" style="width:8rem;border: none;color: black;" class="txtbox" value="" /></td><td><input type="text" name="last_name[]" class="bg-light" style="width:8rem;border: none;color: black;" class="txtbox" value="" /></td><td><input type="email" name="email[]" class="bg-light" style="width:8rem;border: none;color: black;" class="txtbox" value="" /></td><td><input type="tel" pattern="[0-9]{7}" id="twphone" name="wphone[]" class="bg-light" style="width:8rem;border: none;color: black;" class="txtbox" value="" /></td><td><input type="tel" pattern="[0-9]{10}" id="tmobile" onclick="sample1()" name="mobile[]" class="bg-light" style="width:8rem;border: none;color: black;" class="txtbox" value="" /></td><td><input type="number" onclick="sample()" name="skype[]" class="bg-light" style="width:8rem;border: none;color: black;" class="txtbox" value="" /></td><td><input type="text" name="designation[]" class="bg-light" style="width:8rem;border: none;color: black;" class="txtbox" value="" /></td><td><input type="text" name="department[]" class="bg-light" style="width:8rem;border: none;color: black;" class="txtbox" value="" /></td></tr>');
                    });
                  })
            
                  function fieldset5_function()
                  {
                    document.getElementById("address").style.display="block";
                  }
            
                
            
                function myCopyAddressFunction() {
                    var checkBox = document.getElementById("myCheckT");
                    var textatn = document.getElementById("batten");
                    var txtcry = document.getElementById("bctry");
                    var txtadrs11 = document.getElementById("badd1");
                    var txtcty = document.getElementById("bcty");
                    var txtstat = document.getElementById("bste");
                    var txtzip = document.getElementById("bzp");
                    var txtphone = document.getElementById("bphone_num");
                    var txtfx = document.getElementById("bfx");
              
                    var textatn1 = document.getElementById("satten");
                    var txtcry1 = document.getElementById("sctry");
                    var txtadrs21 = document.getElementById("sadd1");
                    var txtcty1 = document.getElementById("scty");
                    var txtstat1 = document.getElementById("sste");
                    var txtzip1 = document.getElementById("szp");
                    var txtphone1 = document.getElementById("sphone_num");
                    var txtfx1 = document.getElementById("sfx");
                    if (checkBox.checked == true) {
                      textatn1.value = textatn.value;
                      txtadrs21.value = txtadrs11.value;
                      txtcty1.value = txtcty.value;
                      txtstat1.value = txtstat.value;
                      txtzip1.value = txtzip.value; 
                      txtphone1.value = txtphone.value;
                      txtfx1.value = txtfx.value;
                      
            
            
            
                      
              
                    } else {
                      txtadrs21.value = "";
                      txtcty1.value = "";
                      txtstat1.value = "";
                      txtzip1.value = "";
                      txtphone1.value = "";
                      txtfx1.value = "";
                      txtcry1.value = "";
                      textatn1.value = "";
            
              
                    }
                  }
            
            
                  function open_table()
                  {
                    document.getElementById("hid").style.display="block";
                    
                  }
            
            
            
                  function work_phone()
                  {
                    var x=document.getElementById("workphone").value;
                    var y=document.getElementById("workphone_label")
                    var expr=/^[0-9]{7}$/;
                    if (!expr.test(x)) {
                        y.style.color="red";
                        y.innerHTML = "Invalid Phone Number.";
                    }
                    else{
                        y.style.color="green";
            
                        y.innerHTML = "valid Phone Number.";
            
                    }
            
            
                  }
            
                  function mobile_phone()
                  {
                    
                    var a=document.getElementById("mphone").value;
                    var b=document.getElementById("mphone_label");
                    var expr=/^[0-9]{10}$/;
                    if (!expr.test(a)) {
                        b.style.color="red";
                        b.innerHTML = "Invalid Phone Number.";
                    }
                    else{
                        b.style.color="green";
            
                        b.innerHTML = "valid Phone Number.";
            
                    }
                  }
            
                  function bphone_number()
                  {
                    var a1=document.getElementById("bphone_num").value;
                    var b1=document.getElementById("bphone_label");
                    var expr=/^[0-9]{10}$/;
                    if (!expr.test(a1)) {
                        b1.style.color="red";
                        b1.innerHTML = "Invalid Phone Number.";
                    }
                    else{
                        b1.style.color="green";
            
                        b1.innerHTML = "valid Phone Number.";
            
                    }
                  }
            
                  function sphone_number()
                  {
                    var a1=document.getElementById("sphone_num").value;
                    var b1=document.getElementById("sphone_label");
                    var expr=/^[0-9]{10}$/;
                    if (!expr.test(a1)) {
                        b1.style.color="red";
                        b1.innerHTML = "Invalid Phone Number.";
                    }
                    else{
                        b1.style.color="green";
            
                        b1.innerHTML = "valid Phone Number.";
            
                    }
                  }
            
                  function fax_number()
                  {
                    var a1=document.getElementById("bfx").value;
                    var b1=document.getElementById("fax_label");
                    var expr=/^[0-9]{7}$/;
                    if (!expr.test(a1)) {
                        b1.style.color="red";
                        b1.innerHTML = "Invalid Phone Number.";
                    }
                    else{
                        b1.style.color="green";
            
                        b1.innerHTML = "valid Phone Number.";
            
                    }
                  }
            
                  function sfax_number()
                  {
                    var a1=document.getElementById("sfx").value;
                    var b1=document.getElementById("sfax_label");
                    var expr=/^[0-9]{7}$/;
                    if (!expr.test(a1)) {
                        b1.style.color="red";
                        b1.innerHTML = "Invalid Phone Number.";
                    }
                    else{
                        b1.style.color="green";
            
                        b1.innerHTML = "valid Phone Number.";
            
                    }
                  }
            
                
                  function sample()
                  {
            
                    var tbldata = document.getElementById("tbl");
                    var total_rows = tbldata.rows.length;
                    x=document.getElementById("tbl");
                    var a1=x.rows[total_rows-1].cells[5].getElementsByTagName('input')[0].value;
            
                    var b1=document.getElementById("tlabel");
            
                    b1.innerHTML = "";
            
                    var expr=/^[0-9]{10}$/;
                    if (!expr.test(a1)) {
                        b1.style.color="red";
                        b1.innerHTML = "Invalid";
                    }
                    else{
                        b1.style.color="green";
                        b1.innerHTML = "valid";
            
                    }
            
                   
            
                  }
            
                  function sample1()
                  {
            
                    var tbldata = document.getElementById("tbl");
                    var total_rows = tbldata.rows.length;
                    x=document.getElementById("tbl");
                    var a1=x.rows[total_rows-1].cells[4].getElementsByTagName('input')[0].value;
            
                    var b1=document.getElementById("twph_label");
            
                    b1.innerHTML = "";
            
                    var expr=/^[0-9]{7}$/;
                    if (!expr.test(a1)) {
                        b1.style.color="red";
                        b1.innerHTML = "Invalid";
                    }
                    else{
                        b1.style.color="green";
                        b1.innerHTML = "valid";
            
                    }
            
                   
            
                  }
            
            
                  
            
                 
            </script>
          </div>
      </div>  
    </div>  

    <!-- payment modal -->


    <div class="modal fade" id="newpayment">
      <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
          <div class="modal-header " style="background: rgb(32, 35, 37);">
              <h3 class="m-3 text-uppercase">Add Payment Term</h3>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>
          <div class="modal-body" style="background: rgb(32, 35, 37);">
            <div class="card p-3 m-3">
              <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalPayment">
                <div class="row mt-2">
                  <div class="col-md-2 mt-2"></div>
                  <div class="col-md-4 mt-2">
                    <center><label for="termname" style="color: rgb(190, 88, 88);">Term Name *</label></center>
                  </div>

                  <div class="col-md-4 mt-2">
                    <center><label for="termdays" style="color: rgb(190, 88, 88);">Number of Days *</label></center>
                  </div>
                  <div class="col-md-2 mt-2"></div>
                </div>


                <div class="row mt-2">
                  <div class="col-md-2 mt-2"></div>

                  <div class="col-md-4 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="term_name" name="term_name" required>      
                  </div>

                  <div class="col-md-4 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="term_days" name="term_days" required>
                  </div>
                  <div class="col-md-2 mt-2"></div>

                </div>
                
                <div class="row mt-5">
                  <div class="col-md-4"></div>
                  <div class="col-md-4">
                    <div class="d-flex">
                      <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                      type="submit" data-dismiss="modal" id="paySave">Save
                      </button> 
                      

                      <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                        data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">Cancel</span>
                      </button>
                    </div>
                  </div>
                  <div class="col-md-4"></div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>  
    </div>  

    <!-- customer modal -->


    <div class="modal fade" id="newcustomer">
      <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
          <div class="modal-header " style="background: rgb(32, 35, 37);">
              <h3 class="m-3 text-uppercase">New Customer</h3>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>
          <div class="modal-body" style="background: rgb(32, 35, 37);">
            <div class="card p-3 m-3">
              <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalCustomer">
        
                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="">Customer Type</label><br>
                  </div>
                  <div class="col-md-6 mt-2">
                    <div class="d-flex">
                      <div class="radio_opt mx-5 mt-2">
                        <input type="radio" id="business" name="radioCust" value="Business" >
                        <label for="option1">Business</label>
                      </div>
                      <div class="radio_opt mx-4 mt-2">
                        <input type="radio" id="individual" name="radioCust" value="Individual" >
                        <label for="option2">Individual</label>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row mt-5">
                  <div class="col-md-3">
                    <label for="ctitle">Title</label>
                  </div>
                  <div class="col-md-3">
                    <select name="ctitle" id="ctitle" class="form-control bg-light text-dark">
                      <option value="Mr." selected>Mr.</option>
                      <option value="Mrs.">Mrs.</option>
                      <option value="Ms.">Ms.</option>
                      <option value="Miss.">Miss.</option>
                      <option value="Dr.">Dr.</option>
                    </select>
                  </div>
                </div>
                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="cfname">First name</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="cfname" name="cfirstname" required>
                  </div>
                </div>
                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="clname">Last name</label>
                    <label id="cdisplayname" name = "cdisplayname" hidden></label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="clname" name="clastname">
                  </div>
                </div>

                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="ccompany">Company Name</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="ccompany" name="ccompany_name">
                  </div>
                </div>

                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="cemail">Customer Email</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="email" class="form-control bg-light text-dark" id="cemail" name="cemail" placeholder="example@gmail.com" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$">    
                  </div>              
                </div>

                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="email">Customer Phone</label>
                  </div>
                  <div class="col-md-3 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="cw_mobile" placeholder="Work Number" maxlength="10" name="cw_mobile">
                  </div>        
                  <div class="col-md-3 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="cp_mobile" placeholder="Personal Number" maxlength="10" name="cp_mobile">
                  </div>          
                </div>

           
                <hr>
                <center><h4 class="text-uppercase mb-3"><b>Other Details</b></h4></center>
                <div class="row mt-5">
                  <div class="col-md-3 mt-2">
                    <label for="facebook">Facebook</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="facebook" placeholder="www.example.com" name="facebook">
                  </div>       
                </div>
                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="twitter">Twitter</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="twitter" placeholder="www.example.com" name="twitter">
                  </div>       
                </div>


                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="website">Website</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="website" placeholder="www.example.com" name="website">
                  </div>       
                </div>

                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="cskype">Skype name/Number</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="cskype" name="cskype">
                  </div>       
                </div>

                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="c_desg">Designation</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="c_desg" name="c_desg">
                  </div>       
                </div>

                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="c_dpt">Department</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="c_dpt" name="c_dpt">
                  </div>       
                </div>

                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="c_gsttype" style="color:rgb(190, 88, 88);">GST Treatment *</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <select class="form-control bg-light text-dark" id="c_gsttype" name="c_gsttype" required>
                      <option value="value" selected>Select a Gst Treatment</option>
                      <option value="Registered Business-Regular Business that is registered under GST">Registered Business-Regular Business that is registered under GST</option>
                      <option value="Registered Business-Composition Business that is registered under the Composition scheme in GST">Registered Business-Composition Business that is registered under the Composition scheme in GST</option>
                      <option value="Unregistered Business-not Registered under GST">Unregistered Business-not Registered under GST</option>
                      <option value="Consumer- A customer who is a regular Consumer">Consumer- A customer who is a regular Consumer</option>
                      <option value="Overseas- Persons with who you do import or exports of supplies outside india">Overseas- Persons with who you do import or exports of supplies outside india</option>
                      <option value="Special Economic Zone">Special Economic Zone</option>
                    </select>
                  </div>       
                </div>

                <!-- <div class="row gstrow d-none">
                  <div class="col-md-3 mt-2">
                    <label id="glbl" style="color:rgb(190, 88, 88);">GSTIN/UIN *</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control" id="v_gstin" name="v_gstin" placeholder="29APPCK7465F1Z1">
                    <label id="gst_label"></label>
                  </div>       
                </div>

                <div class="row">
                  <div class="col-md-3 mt-2">
                    <label for="v_pan">PAN Number</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control" id="v_pan" name="v_pan" placeholder="APPCK7465F">
                    <label id="pan_label"></label>
                  </div>       
                </div> -->

                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="" style="color: rgb(190, 88, 88);">Place of Supply *</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <select class="form-control bg-light text-dark" id="placesupply" name="placesupply">
                      <option value="Nill"></option>
                      <option value="[AN] Andaman and Nicobar Islads">[AN] Andaman and Nicobar Islads</option>
                      <option value="[AD] Andhra Predhesh">[AD] Andhra Predhesh</option>
                      <option value="[AR] Arunachal Predesh">[AR] Arunachal Predesh</option>
                      <option value="[AS] Assam">[AS] Assam</option>
                      <option value="[BR] Bihar">[BR] Bihar</option>
                      <option value="[CH] Chandigarh">[CH] Chandigarh</option>
                      <option value="[CG] Chhattisgarh">[CG] Chhattisgarh</option>
                      <option value="[DNH] Dadra and Nagar Haveli">[DNH] Dadra and Nagar Haveli</option>
                      <option value="[DD] Damn anad Diu">[DD] Damn anad Diu</option>
                      <option value="[DL] Delhi">[DL] Delhi</option>
                      <option value="[GA] Goa">[GA] Goa</option>
                      <option value="[GJ] Gujarat">[GJ] Gujarat</option>
                      <option value="[HR] Haryana">[HR] Haryana</option>
                      <option value="[HP] Himachal Predesh">[HP] Himachal Predesh</option>
                      <option value="[JK] Jammu and Kashmir">[JK] Jammu and Kashmir</option>
                      <option value="[JH] Jharkhand">[JH] Jharkhand</option>
                      <option value="[KA] Karnataka">[KA] Karnataka</option>
                      <option value="[KL] Kerala">[KL] Kerala</option>
                      <option value="[LA] Ladakh">[LA] Ladakh</option>
                      <option value="[LD] Lakshadweep">[LD] Lakshadweep</option>
                      <option value="[MP] Madhya Predesh">[MP] Madhya Predesh</option>
                      <option value="[MH] Maharashtra">[MH] Maharashtra</option>
                      <option value="[MN] Manipur">[MN] Manipur</option>
                      <option value="[ML] Meghalaya">[ML] Meghalaya</option>
                      <option value="[MZ] Mizoram">[MZ] Mizoram</option>
                      <option value="[NL] Nagaland">[NL] Nagaland</option>
                      <option value="[OD] Odisha">[OD] Odisha</option>
                      <option value="[PY] Puducherry">[PY] Puducherry</option>
                      <option value="[PB] Punjab">[PB] Punjab</option>
                      <option value="[RJ] Rajasthan">[RJ] Rajasthan</option>
                      <option value="[SK] Sikkim">[SK] Sikkim</option>
                      <option value="[TN] Tamil Nadu">[TN] Tamil Nadu</option>
                      <option value="[TS] Telangana">[TS] Telangana</option>
                      <option value="[TR] Tripura">[TR] Tripura</option>
                      <option value="[UP] Uttar Predesh">[UP] Uttar Predesh</option>
                      <option value="[UK] Uttarakhand">[UK] Uttarakhand</option>
                      <option value="[WB] West Bengal">[WB] West Bengal</option>
                      <option value="[OT] Other Territory">[OT] Other Territory</option>
                    </select>
                  </div>       
                </div>

                <div class="row mt-2">
                  <div class="col-md-4 ">
                    <label for="c_tax" style="color: rgb(190, 88, 88);">Tax Preference * </label>
                  </div>
                  <div class="col-md-5">
                    <div class="d-flex">
                      <div class="radio_opt mx-5 mt-2">
                        <input type="radio" id="item-tax3" name="radioOption2" value="Taxable" >
                        <label for="option3">Taxable</label>
                      </div>
                      <div class="radio_opt mx-4 mt-2">
                        <input type="radio" id="item-tax4" name="radioOption2" value="Tax-exempt" >
                        <label for="option4">Tax-exempt</label>
                      </div>
                    </div>
                  </div>       
                </div>

                <div class="row mt-2 mb-4 d-none inter-intra" >
                  <div class="col-md-3">
                    <label for="intra">Intra-State TAX</label>
                  </div>
                  <div class="col-md-3">
                    <select name="intra" class="form-control bg-light text-dark" id="intra1">
                      <option value="">Select GST</option>

                      <option value="GST0[0%]">GST0[0%]</option>
                      <option value="GST5[5%]">GST5[5%]</option>
                      <option value="GST12[12%]">GST12[12%]</option>
                      <option value="GST18[18%]">GST18[18%]</option>
                      <option value="GST28[28%]">GST28[28%]</option>
                    </select>             
                  </div>

                  
                  <div class="col-md-2">
                    <label for="inter">Inter-State TAX</label>
                  </div>
                  <div class="col-md-3">
                    <select name="inter" class="form-control bg-light text-dark" id="inter1">
                      <option value="">Select GST</option>

                      <option value="IGST0[0%]">IGST0[0%]</option>
                      <option value="IGST5[5%]">IGST5[5%]</option>
                      <option value="IGST12[12%]">IGST12[12%]</option>
                      <option value="IGST18[18%]">IGST18[18%]]</option>
                      <option value="IGST28[28%]">IGST28[28%]</option>
                    </select>               
                  </div>
                  <div class="col-md-1"></div>

                </div>
                
                <hr>

                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="c_curn">Currency </label>
                  </div>
                  <div class="col-md-3 mt-2">
                    <select class="form-control bg-light text-dark"id="c_curn" name="c_curn" required>
                      <option selected disabled value="">Choose..</option>
                      <option value="INR">INR</option>
                    </select>
                  </div>       
                </div>

                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="c_open">Opening Balance</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="c_open" name="c_open">
                  </div>       
                </div>

                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="c_terms">Payment Terms</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <div class="d-flex">
                      <select class="form-control bg-light text-dark" id="c_terms" name="c_terms" required>
    
                        {% for p in payment %}
                        <option value="{{p.Terms}} {{p.id}}">{{p.Terms}}</option>
                        {% endfor %}
                      </select>                
                    </div>
                  </div>       
                </div>
                

                <hr>

                <div class="row">
                  <div class="col-md-6 mt-5 text-center text-uppercase">
                    <h4 class="mb-0">Billing Address</h4>
                  </div>
                  <div class="col-md-6 mt-5">
                    <h4 class="mb-0 text-center text-uppercase">Shipping Address</h4>
                  </div>
                </div>
                <div class="row mt-2 m-0 p-0 mb-2">
                  <div class="col-md-9"> </div>
                  <div class="col-md-3 text-right  m-0 p-0">
                    <input type="checkbox" onclick="address()" id="voka" name="vokay">
                    <label for="voka" style="color: #909091;">Same As Billing Address</label>
                  </div>
                </div>

                <div class="row mt-5">
                  <div class="col-md-1">
                    <label for="cstreet">Address</label>
                  </div>
                  <div class="col-md-4">
                    <textarea class="form-control bg-light text-dark street" id="cstreet" name="vstreet"></textarea>
                  </div>
                  <div class="col-md-1"></div>

                  <div class="col-md-1">
                    <label for="csstreet">Address</label>
                  </div>
                  <div class="col-md-4 ">
                    <textarea class="form-control bg-light text-dark street" id="csstreet" name="vsstreet"></textarea>
                  </div>
                  <div class="col-md-1"></div>

                </div>

                <div class="row mt-2">
                  <div class="col-md-1">
                    <label for="ccity">City</label>
                  </div>
                  <div class="col-md-4">
                    <input type="text" class="form-control bg-light text-dark" id="ccity" name="vcity" placeholder="City">  
                  </div>
                  <div class="col-md-1">
                  </div>
                  <div class="col-md-1">
                    <label for="cscity">City</label>
                  </div>
                  <div class="col-md-4">
                    <input type="text" class="form-control bg-light text-dark" id="cscity" name="cscity" placeholder="City">  
                  </div>
                  <div class="col-md-1">
                  </div>
                </div>

                <div class="row mt-2">
                  <div class="col-md-1">
                    <label for="cstate">State</label>
                  </div>
                  <div class="col-md-4">
                    <select type="text" class="form-control bg-light text-dark" id="cstate" name="vstate">
                      <option value="" selected>Choose</option>
                      <option value="None Of This">None Of This</option>
                      <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads
                      </option>
                      <option value="Andhra Predhesh">Andhra Predhesh</option>
                      <option value="Arunachal Predesh">Arunachal Predesh</option>
                      <option value="Assam">Assam</option>
                      <option value="Bihar">Bihar</option>
                      <option value="Chandigarh">Chandigarh</option>
                      <option value="Chhattisgarh">Chhattisgarh</option>
                      <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                      <option value="Damn anad Diu">Damn anad Diu</option>
                      <option value="Delhi">Delhi</option>
                      <option value="Goa">Goa</option>
                      <option value="Gujarat">Gujarat</option>
                      <option value="Haryana">Haryana</option>
                      <option value="Himachal Predesh">Himachal Predesh</option>
                      <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                      <option value="Jharkhand">Jharkhand</option>
                      <option value="Karnataka">Karnataka</option>
                      <option value="Kerala">Kerala</option>
                      <option value="Ladakh">Ladakh</option>
                      <option value="Lakshadweep">Lakshadweep</option>
                      <option value="Madhya Predesh">Madhya Predesh</option>
                      <option value="Maharashtra">Maharashtra</option>
                      <option value="Manipur">Manipur</option>
                      <option value="Meghalaya">Meghalaya</option>
                      <option value="Mizoram">Mizoram</option>
                      <option value="Nagaland">Nagaland</option>
                      <option value="Odisha">Odisha</option>
                      <option value="Puducherry">Puducherry</option>
                      <option value="Punjab">Punjab</option>
                      <option value="Rajasthan">Rajasthan</option>
                      <option value="Sikkim">Sikkim</option>
                      <option value="Tamil Nadu">Tamil Nadu</option>
                      <option value="Telangana">Telangana</option>
                      <option value="Tripura">Tripura</option>
                      <option value="Uttar Predesh">Uttar Predesh</option>
                      <option value="Uttarakhand">Uttarakhand</option>
                      <option value="West Bengal">West Bengal</option>
                      <option value="Other Territory">Other Territory</option>
                    </select>
                  </div>
                  <div class="col-md-1"></div>
  
                  <div class="col-md-1">
                    <label for="csstate">State</label>
                  </div>
                  <div class="col-md-4 ">
                    <select type="text" class="form-control bg-light text-dark" id="csstate" name="vsstate">
                      <option value="" selected>Choose</option>
                      <option value="None Of This">None Of This</option>
                      <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads
                      </option>
                      <option value="Andhra Predhesh">Andhra Predhesh</option>
                      <option value="Arunachal Predesh">Arunachal Predesh</option>
                      <option value="Assam">Assam</option>
                      <option value="Bihar">Bihar</option>
                      <option value="Chandigarh">Chandigarh</option>
                      <option value="Chhattisgarh">Chhattisgarh</option>
                      <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                      <option value="Damn anad Diu">Damn anad Diu</option>
                      <option value="Delhi">Delhi</option>
                      <option value="Goa">Goa</option>
                      <option value="Gujarat">Gujarat</option>
                      <option value="Haryana">Haryana</option>
                      <option value="Himachal Predesh">Himachal Predesh</option>
                      <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                      <option value="Jharkhand">Jharkhand</option>
                      <option value="Karnataka">Karnataka</option>
                      <option value="Kerala">Kerala</option>
                      <option value="Ladakh">Ladakh</option>
                      <option value="Lakshadweep">Lakshadweep</option>
                      <option value="Madhya Predesh">Madhya Predesh</option>
                      <option value="Maharashtra">Maharashtra</option>
                      <option value="Manipur">Manipur</option>
                      <option value="Meghalaya">Meghalaya</option>
                      <option value="Mizoram">Mizoram</option>
                      <option value="Nagaland">Nagaland</option>
                      <option value="Odisha">Odisha</option>
                      <option value="Puducherry">Puducherry</option>
                      <option value="Punjab">Punjab</option>
                      <option value="Rajasthan">Rajasthan</option>
                      <option value="Sikkim">Sikkim</option>
                      <option value="Tamil Nadu">Tamil Nadu</option>
                      <option value="Telangana">Telangana</option>
                      <option value="Tripura">Tripura</option>
                      <option value="Uttar Predesh">Uttar Predesh</option>
                      <option value="Uttarakhand">Uttarakhand</option>
                      <option value="West Bengal">West Bengal</option>
                      <option value="Other Territory">Other Territory</option>
                    </select>
                  </div>

                  <div class="col-md-1"></div>

                </div>

                <div class="row mt-2">
                  <div class="col-md-1">
                    <label for="ccountry">Country</label>
                  </div>
                  <div class="col-md-4 ">
                    <input type="text" class="form-control bg-light text-dark" id="ccountry" name="vcountry" placeholder="Country">  
                  </div>
                  <div class="col-md-1"></div>

                  <div class="col-md-1">
                    <label for="cscountry">Country</label>
                  </div>
                  <div class="col-md-4">
                    <input type="text" class="form-control bg-light text-dark" id="cscountry"  name="vscountry" placeholder="Country">
                  </div>
                  <div class="col-md-1 "></div>

                </div>

                <div class="row mt-2">

                  <div class="col-md-1">
                    <label for="cpincode">Pincode</label>
                  </div>
                  <div class="col-md-4">
                    <input type="text" class="form-control bg-light text-dark" id="cpincode" name="vpincode" maxlength="6" placeholder="PIN Code"> 
                  </div>
                  <div class="col-md-1"></div>

                  <div class="col-md-1">
                    <label for="cspincode">Pincode</label>
                  </div>
                  <div class="col-md-4">
                    <input type="text" class="form-control bg-light text-dark" id="cspincode" name="vspincode" maxlength="6"  placeholder="PIN Code">  
                  </div>
                  <div class="col-md-1"></div>

                </div>

                <div class="row mt-2">

                  <div class="col-md-1">
                    <label for="cphone">Phone</label>
                  </div>
                  <div class="col-md-4">
                    <input type="text" class="form-control bg-light text-dark" id="cphone" name="vphone"  placeholder="Phone"> 
                  </div>
                  <div class="col-md-1"></div>

                  <div class="col-md-1">
                    <label for="csphone">Phone</label>
                  </div>
                  <div class="col-md-4">
                    <input type="text" class="form-control bg-light text-dark" id="csphone" name="vsphone"  placeholder="Phone">  
                  </div>
                  <div class="col-md-1"></div>

                </div>

                <div class="row mt-2">

                  <div class="col-md-1">
                    <label for="cfax">Fax</label>
                  </div>
                  <div class="col-md-4">
                    <input type="text" class="form-control bg-light text-dark" id="cfax" name="vfax"  placeholder="FAX"> 
                  </div>
                  <div class="col-md-1"></div>

                  <div class="col-md-1">
                    <label for="csfax">Fax</label>
                  </div>
                  <div class="col-md-4">
                    <input type="text" class="form-control bg-light text-dark" id="csfax" name="vsfax"  placeholder="FAX">  
                  </div>
                  <div class="col-md-1"></div>

                </div>

                <div class="row mt-2">
                    <div class="col-md-6">
                      <input type="checkbox" value="" id="invalidCheck" name="invalidCheck" required>
                      <label for="invalidCheck" style="color: #909091;">Agree to terms and conditions</label>
                      <div class="invalid-feedback text-warning" >You must agree before submitting.</div>
                    </div>
                </div>
                <div class="row mt-5">
                  <div class="col-md-4"></div>
                  <div class="col-md-4">
                    <div class="d-flex">
                      <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                      type="submit" data-dismiss="modal" id="customersave"  >Submit
                      </button> 

                      <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                        data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">Cancel</span>
                      </button>
                    </div>
                  </div>
                  <div class="col-md-4"></div>
                </div>
              </form>
                  </div>
              </div>
          </div>
      </div>  
    </div>  

    <!-- item modal -->

    <div class="modal fade" id="newitem">
      <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
          <div class="modal-header " style="background: rgb(32, 35, 37);">
              <h3 class="m-3 text-uppercase">New Item</h3>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>
          <div class="modal-body" style="background: rgb(32, 35, 37);">
            <div class="card p-3 m-3">
              <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalItem">

                <div class="row mt-2">
                  <div class="col-md-4 mr-0">
                    <label class="col-form-label col-sm-2 p-0">Type <i class="fa fa-question-circle"></i></label>
                  </div>
                  <div class="col-md-5 ml-0 d-flex">
                    <div class="radio_opt mx-5 ">
                      <input type="radio" id="item_type1" name="radioOption" value="Goods" >
                      <label for="option1">Goods</label>
                    </div>
                    <div class="radio_opt mx-5 ">
                      <input type="radio" id="item_type2" name="radioOption" value="Services" >
                      <label for="option2">Services</label>
                    </div>
                  </div>
                </div>
                <div class="row mt-2">
                  <div class="col-md-3">
                    <label for="name" style="color: rgb(190, 88, 88);">Name *</label>
                  </div>
                  <div class="col-md-6">
                    <input type="text" class="form-control bg-light text-dark" id="item_name" name="item_name" required>
                  </div>
                </div>
                <div class="row mt-2">
                  <div class="col-md-3">
                    <label for="hsn" style="color: rgb(190, 88, 88);">HSN Code *</label>
                  </div>
                  <div class="col-md-6">
                    <input type="number" class="form-control bg-light text-dark" id="hsn" name="hsn" maxlength="6" oninput="validateInput(this)" required>
                  </div>
                </div>
                
                <div id="validationResult"></div>
                
                <script>
                  function validateSixDigits(field) {
                    // Define the regular expression pattern for exactly six digits
                    var pattern = /^\d{6}$/;
                
                    // Check if the field matches the pattern
                    return pattern.test(field);
                  }
                
                  function validateInput(inputField) {
                    var inputValue = inputField.value;
                    var validationResultDiv = document.getElementById("validationResult");
                
                    if (validateSixDigits(inputValue)) {
                      validationResultDiv.textContent = "Valid: The field contains exactly six digits.";
                    } else {
                      validationResultDiv.textContent = "Invalid: The field does not contain exactly six digits.";
                    }
                  }
                </script>
                

                <div class="row mt-2">
                  <div class="col-md-3 ">
                    <label for="units">Unit</label>
                  </div>
                  <div class="col-md-6">
                    <div class="d-flex">
                      <select class="form-control bg-light text-dark" id="item_units" name="item_units" required>
                        <option value="">Select Unit</option>
                        {% for u in units %}
                        <option value="{{u.id}}">{{u.unit}}</option>
                        {% endfor %}
                      </select>                
                      <a href="#" class="btn btn-outline-secondary py-2 my-1" data-target="#newunit" data-toggle="modal">+</a>  
                    </div>
                  </div>
                </div>

                

                <!-- <div class="form-group row">
              <label  class="col-sm-2 col-form-label">HSN Code</label> 
              <div class="col-sm-10 col-md-7 col-9"  style="margin-left: -2.2rem;" >
                <input required type="number" class="form-control bg-dark" name="hsn" id="myInputField" oninput="validateInput()">
                <div id="validationResult"></div>
              </div>
            </div> -->

                <div class="row mt-2">
                  <div class="col-md-4 ">
                    <label for="c_tax" style="color: rgb(190, 88, 88);">Tax Preference * </label>
                  </div>
                  <div class="col-md-5">
                    <div class="d-flex">
                      <div class="radio_opt mx-5 mt-2">
                        <input type="radio" id="item-tax1" name="radioOption1" value="Taxable" >
                        <label for="option1">Taxable</label>
                      </div>
                      <div class="radio_opt mx-4 mt-2">
                        <input type="radio" id="item-tax2" name="radioOption1" value="Tax-exempt" >
                        <label for="option2">Tax-exempt</label>
                      </div>
                    </div>
                  </div>       
                </div>

                <div class="row mt-2 mb-4 d-none inter-intra" >
                  <div class="col-md-3">
                    <label for="intra">Intra-State TAX</label>
                  </div>
                  <div class="col-md-3">
                    <select name="intra" class="form-control bg-light text-dark" id="intra">
                      <option value="">Select GST</option>

                      <option value="GST0[0%]">GST0[0%]</option>
                      <option value="GST5[5%]">GST5[5%]</option>
                      <option value="GST12[12%]">GST12[12%]</option>
                      <option value="GST18[18%]">GST18[18%]</option>
                      <option value="GST28[28%]">GST28[28%]</option>
                    </select>             
                  </div>

                  
                  <div class="col-md-2">
                    <label for="inter">Inter-State TAX</label>
                  </div>
                  <div class="col-md-3">
                    <select name="inter" class="form-control bg-light text-dark" id="inter">
                      <option value="">Select GST</option>

                      <option value="IGST0[0%]">IGST0[0%]</option>
                      <option value="IGST5[5%]">IGST5[5%]</option>
                      <option value="IGST12[12%]">IGST12[12%]</option>
                      <option value="IGST18[18%]">IGST18[18%]]</option>
                      <option value="IGST28[28%]">IGST28[28%]</option>
                    </select>               
                  </div>
                  <div class="col-md-1"></div>

                </div>
                
                <hr>

                <div class="row mt-5 text-center">
                  <div class="col-md-6 d-flex text-center">
                    <input  type="checkbox" name="selling" checked class="mx-2 my-0">
                    <h6 class="m-0">Selling Information</h6>
                  </div>
                  <div class="col-md-6 d-flex text-center">
                    <input  type="checkbox" name="purchase" checked class="mx-2 my-0">
                    <h6 class="m-0">Purchase Information</h6>
                  </div>
                </div>
                
                <div class="row mt-4">
                  <div class="col-md-2">
                    <label for="sell_price">Selling Price *</label>
                  </div>
                  <div class="col-md-4">
                    <div class="input-group mb-2">
                      <div class="input-group-prepend">
                        <div class="input-group-text">INR</div>
                      </div>
                      <input required type="text" class="form-control bg-light text-dark" name="sell_price" id="sell_price">
                    </div>                  
                  </div>

                  <div class="col-md-2">
                    <label for="cost_price">Cost Price *</label>
                  </div>
                  <div class="col-md-4 ">
                    <div class="input-group mb-2">
                      <div class="input-group-prepend">
                        <div class="input-group-text">INR</div>
                      </div>
                      <input required type="text" class="form-control bg-light text-dark" name="cost_price" id="cost_price">
                    </div>
                  </div>
                </div>

                <div class="row mt-2">
                  <div class="col-md-2">
                    <label for="vcity">Account</label>
                  </div>
                  <div class="col-md-4">
                    <select name="sell_acc" id="sell_acc" class="form-control bg-light text-dark">
                      <option value="">Select Account</option>
       
                        <option value="" disabled class="btn btn-dark text-white"><b>SALES</b></option>
                        {% for s in sales %}
                            <option value="{{s.id}}">{{ s.Account_name }}</option>
                      {% endfor %}
                    </select> 
                  </div>
                  <div class="col-md-2">
                    <label for="cost_acc">Account</label>
                  </div>
                  <div class="col-md-4">
                    <select name="cost_acc" class="form-control bg-light text-dark" id="cost_acc">
                      <option value="">Select Account</option>


                      
                        <option value="" disabled class="btn btn-dark text-white"><b>PURCHASE</b></option>
                        {% for p in purchase %}
                            <option value="{{p.id}}">{{ p.Account_name }}</option>
                      {% endfor %}

                    </select> 
                  </div>
                </div>

                <div class="row mt-2">
                  <div class="col-md-2">
                    <label for="sell_desc">Description</label>
                  </div>
                  <div class="col-md-4">
                    <input  type="text" name="sell_desc" class="form-control bg-light text-dark"  id="sell_desc">
                  </div>
  
                  <div class="col-md-2">
                    <label for="cost_desc">Description</label>
                  </div>
                  <div class="col-md-4 ">
                    <input  type="text" name="cost_desc" class="form-control bg-light text-dark"  id="cost_desc">
                  </div>

                </div>

                <div class="row mt-3">
                    <div class="col-md-6">
                      <input type="checkbox" value="" id="invalidCheck" name="invalidCheck" required>
                      <label for="invalidCheck" style="color: #909091;">Agree to terms and conditions</label>
                      <div class="invalid-feedback text-warning" >You must agree before submitting.</div>
                    </div>
                </div>
                <div class="row">
                  <div class="col-md-4"></div>
                  <div class="col-md-4">
                    <div class="d-flex">
                      <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                      type="submit" data-dismiss="modal" id="itemSave">Submit
                      </button> 

                      <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                        data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">Cancel</span>
                      </button>
                    </div>
                  </div>
                  <div class="col-md-4"></div>
                </div>
              </form>
                  </div>
              </div>
          </div>
      </div>  
    </div>  


    <!-- unit modal -->

    <div class="modal fade" id="newunit">
      <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
          <div class="modal-header " style="background: rgb(32, 35, 37);">
              <h3 class="m-3 text-uppercase">Add Unit</h3>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>
          <div class="modal-body" style="background: rgb(32, 35, 37);">
            <div class="card p-3 m-3">
              <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalUnit">
                <div class="row mt-2">
                  <div class="col-md-3 mt-2"></div>
                  <div class="col-md-1 mt-2">
                    <label for="unit" style="color: rgb(190, 88, 88);">Unit</label>
                  </div>

                  <div class="col-md-4 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="unit" name="unit" required>
                  </div>
                  <div class="col-md-4 mt-2"></div>
                </div>
                
                <div class="row mt-5">
                  <div class="col-md-4"></div>
                  <div class="col-md-4">
                    <div class="d-flex">
                      <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                      type="submit" data-dismiss="modal" id="unitSave">Save
                      </button> 
                      

                      <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                        data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">Cancel</span>
                      </button>
                    </div>
                  </div>
                  <div class="col-md-4"></div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>  
    </div>  


    <!-- account modal -->

    <div class="modal fade" id="newaccount">
      <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
          <div class="modal-header " style="background: rgb(32, 35, 37);">
              <h3 class="m-3 text-uppercase">New Account</h3>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>
          <div class="modal-body" style="background: rgb(32, 35, 37);">
            <div class="card p-3 m-3">
              <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalAccount">
        
                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="">Account Type</label><br>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="acct_type" name="acct_type" required>
                  </div>
                </div>
                
                <div class="row mt-2">
                  <div class="col-md-3 mt-2">
                    <label for="cfname">Account name</label>
                  </div>
                  <div class="col-md-6 mt-2">
                    <input type="text" class="form-control bg-light text-dark" id="acct_name" name="acct_name" required>
                  </div>
                </div>            

                <div class="row mt-5">
                  <div class="col-md-4"></div>
                  <div class="col-md-4">
                    <div class="d-flex">
                      <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                      type="submit" data-dismiss="modal" id="accountSave">Submit
                      </button> 

                      <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                        data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">Cancel</span>
                      </button>
                    </div>
                  </div>
                  <div class="col-md-4"></div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>  
    </div>  


    <!-- end of modal -->



    
  </div>
  </div>
</div>

<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> -->


<script>
  

 


  $(document).ready(function() {
  //   console.log("selectize");
  //   $('#vendor').selectize({
  // sortField: 'value',
  // render: {
  //  item: function (item, escape) {
  //    if (item.value === '') {
  //      return '';
  //    }
  //    console.log("ssssssssssssss");

  //    return '<div>' + escape(item.text) + '</div>';
  //  }
  // }
  // });
  console.log("finish");
  var item_list;
  fetch_vendor();
  function fetch_vendor(){
    var name = $("#vendor").val();
        var na = name.split(' ');
        $.ajax({
            url: "{% url 'get_vendor_credit_det' %}",
            data: { 
                fname : na[0],
                lname : na[1],
                id : na[2],
                csrfmiddlewaretoken: '{{ csrf_token }}' 
            },
            type : 'POST',
            success: function(data) {
                console.log(data.bill_nos)
                $("#email_row").removeClass('d-none');
                $("#email_row").addClass('d-flex');
                $("#gst_trt_row").removeClass('d-none');
                $("#gst_trt_row").addClass('d-flex');
                $("#address_row").removeClass('d-none');
                $("#address_row").addClass('d-flex');
                
                // Check if any input box is empty in the GSTIN row
                if (!data.gst_number || !data.vendor_email || !data.gst_treatment) {
                    $("#gstin_row").removeClass('d-flex');
                    $("#gstin_row").addClass('d-none');
                } else {
                    $("#gstin_row").removeClass('d-none');
                    $("#gstin_row").addClass('d-flex');
                }

                // Check if any input box is empty in the Address row
                if (!data.baddress) {
                    $("#address_row").removeClass('d-flex');
                    $("#address_row").addClass('d-none');
                } else {
                    $("#address_row").removeClass('d-none');
                    $("#address_row").addClass('d-flex');
                }

                $('#email_inp').val(" " + data.vendor_email);
                $('#gst_trt_inp').val(" " + data.gst_treatment);
                $('#gstin_inp').val(" " + data.gst_number);
                $('#address_inp').val(" " + data.baddress);

                $('#srcofsupply').val(data.placeofsuply);

                console.log(data.bill_nos);
                $('#billno').empty();
                // $('#billno').append($('<option>', {value: '',text: 'Select'}));

                  $.each(data.bill_nos, function(key, value) {
                      $.each(value, function(bill_no, name) {
                          $('#billno').append($('<option>', {
                              value: name+" "+bill_no,
                              text: bill_no
                          }));
                          
                      });
              });
              
              $('#billno').val('{{po.bill_number}}')
              console.log($('#billno').val());
              var bill_no =$('#billno').val();
                    console.log(bill_no)
                    var parts = bill_no.split(' ');
                    console.log(parts[0])
                    $.ajax({
                          url: "{% url 'get_bill_item' %}",
                          data: { 
                              id : parts[1],
                              name : parts[0],
                              csrfmiddlewaretoken: '{{ csrf_token }}' 
                          },
                          type : 'POST',
                          success: function(data) {
                              console.log(data)
                              item_list=data
                          }
                        });

               
            }
        });
      }

    $('#vendor').change(function() {
      fetch_vendor();
        
        
    });

    $('#billno').change(function() {
       var bill_no =$(this).val();
       console.log(bill_no)
       var parts = bill_no.split(' ');
       console.log(parts[0])
       $.ajax({
            url: "{% url 'get_bill_item' %}",
            data: { 
                id : parts[1],
                name : parts[0],
                csrfmiddlewaretoken: '{{ csrf_token }}' 
            },
            type : 'POST',
            success: function(data) {
                console.log(data)
                item_list=data
            }
          });
    });



    $(document).on('change', '.itm', function() {
      var $closestRow = $(this).closest('tr');

        var selectedItemId = $(this).val();
        if (item_list[selectedItemId] !== undefined) {
            console.log("Selected item is in the item list.");
            console.log("Item name:", selectedItemId);
            console.log("Item value:", item_list[selectedItemId]);
            $closestRow.find('.maxqty').val(item_list[selectedItemId]);
        } else {
            alert("You have selected a wrong item.");
            $closestRow.find('.maxqty').val(0);
          }

    });

            $('#upi').hide();
            $('#cheque').hide();
            $('#bnk').hide();
            
            var selectedOption = $('#pay_method').val();
            if (selectedOption === 'Cash') {
                $('#cheque').hide();
                $('#upi').hide();
                $('#bnk').hide();
                
            }
            
            if (selectedOption === 'Cheque') {
                $('#cheque').show();
                $('#upi').hide();
                $('#bnk').hide();
                
            }
            if (selectedOption === 'UPI') {
                    $('#upi').show();
                    $('#cheque').hide();
                    $('#bnk').hide();
                    
                }
                if (selectedOption != 'UPI' && selectedOption != 'Cheque' && selectedOption != 'Cash') {
                    $('#upi').hide();
                    $('#cheque').hide();
                    $('#bnk').show();
                    
                }

    $('#pay_method').change(function () {

            $('#upi').hide();
            $('#cheque').hide();
            $('#bnk').hide();
            
            var selectedOption = $(this).val();
            
            if (selectedOption === 'Cheque') {
                $('#cheque').show();
                $('#upi').hide();
                $('#bnk').hide();
                $('#chequeno').prop('required', true);
                $('#upiid').prop('required', false);
            }
            if (selectedOption === 'UPI') {
                    $('#upi').show();
                    $('#cheque').hide();
                    $('#bnk').hide();
                    $('#upiid').prop('required', true);
                    $('#chequeno').prop('required', false);
                }
            if (selectedOption != 'UPI' && selectedOption != 'Cheque' && selectedOption != 'Cash') {
                    $('#bnk').show();
                    $('#upi').hide();
                    $('#cheque').hide();
                    $.ajax({
                        type: "GET",
                        url: "{% url 'getacc' %}",
                        data: {
                            id: selectedOption
                        },
                        success: function (response) {
                            console.log(response)
                            $('#accountno').val(response.acc);

                        }
                    });
            }

      });
});




$(document).ready(function() {
  $('#custom').change(function() {
    var name = $("#custom").val();
    var na = name.split(' ');
    console.log(name)
    $.ajax({
      url: "{% url 'customer_det' %}",
      data: {
        name:name,
        csrfmiddlewaretoken: '{{ csrf_token }}'
      },
      type: 'POST',
      success: function(data) {
        $("#cemail_inp").val(data.customer_email);
        $("#custAddress").val(data.adres);
        $("#custstreet").val(data.streat);
        $("#custcity").val(data.city);
        $("#custstate").val(data.state);
        document.getElementById('company_state').value = data.st

      }
    });
  });
});







  $(document).ready(function() {
    $("#fname, #lname").change(function() {
      $("#vdisplayname").text($("#title").val() +" " + $("#fname").val() + " " + $("#lname").val());
    });
  });


  $(document).ready(function() {
    $("#v_gsttype").change(function() {
      var x=$('#v_gsttype').val();
      // console.log(x)
      if(x=="unregistered Business") 
      {
        $(".gstrow").addClass('d-none');

      }
      else if(x == 'Overseas'){
        $(".gstrow").addClass('d-none');
      }
      else 
      {
        $(".gstrow").removeClass('d-none');
        $(".gstrow").addClass('d-flex');
      }
    
    });
  });


    $(document).ready(function() {
    $("#v_gstin").change(function() {

        var x=$("v_gstin").val();
        var gst_label=document.getElementById("gst_label")
        var expr=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;
        if (!expr.test(x)) {
            gst_label.style.color="red";
            gst_label.innerHTML = "Invalid GST Number.";
        }
        else{
            gst_label.style.color="green";
            gst_label.innerHTML = "valid GST Number.";

        }
      });
    });

    $(document).ready(function() {
      $("#v_pan").change(function() {
        var x= $("#v_pan").val();
        var pan_label=document.getElementById("pan_label")
        var expr=    /^[A-Z]{5}[0-9]{4}[A-Z]{1}$/
        if (!expr.test(x)) {
            pan_label.style.color="red";
            pan_label.innerHTML = "Invalid PAN Number.";
        }
        else{
            pan_label.style.color="green";
            pan_label.innerHTML = "valid PAN Number.";

        }
      });
    });

    $(document).ready(function() {
    $("#cfname, #clname").change(function() {
      $("#cdisplayname").text($("#ctitle").val() +" " + $("#cfname").val() + " " + $("#clname").val());
    });
  });


  $(document).ready(function() {
    $("#c_gsttype").change(function() {
      var x=$('#c_gsttype').val();
      // console.log(x)
      if(x=="unregistered Business") 
      {
        $(".gstrow").addClass('d-none');

      }
      else if(x == 'Overseas'){
        $(".gstrow").addClass('d-none');
      }
      else 
      {
        $(".gstrow").removeClass('d-none');
        $(".gstrow").addClass('d-flex');
      }
    
    });
  });


    $(document).ready(function() {
    $("#c_gstin").change(function() {

        var x=$("c_gstin").val();
        var gst_label=document.getElementById("gst_label")
        var expr=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;
        if (!expr.test(x)) {
            gst_label.style.color="red";
            gst_label.innerHTML = "Invalid GST Number.";
        }
        else{
            gst_label.style.color="green";
            gst_label.innerHTML = "valid GST Number.";

        }
      });
    });

    $(document).ready(function() {
      $("#c_pan").change(function() {
        var x= $("#c_pan").val();
        var pan_label=document.getElementById("pan_label")
        var expr=    /^[A-Z]{5}[0-9]{4}[A-Z]{1}$/
        if (!expr.test(x)) {
            pan_label.style.color="red";
            pan_label.innerHTML = "Invalid PAN Number.";
        }
        else{
            pan_label.style.color="green";
            pan_label.innerHTML = "valid PAN Number.";

        }
      });
    });


  function addressSame(){
    var chkbtn = document.getElementById('vokay');
    if (chkbtn.checked == true) {
      document.getElementById('vsstreet').value = document.getElementById('vstreet').value;
      document.getElementById('vscity').value = document.getElementById('vcity').value;
      document.getElementById('vspincode').value = document.getElementById('vpincode').value;
      document.getElementById('vscountry').value = document.getElementById('vcountry').value;
      document.getElementById('vsstate').value = document.getElementById('vstate').value;
      document.getElementById('vsphone').value = document.getElementById('vphone').value;
      document.getElementById('vsfax').value = document.getElementById('vfax').value;
    } 
    else {
      document.getElementById('vsstreet').value = '';
      document.getElementById('vscity').value = '';
      document.getElementById('vsstate').value = '';
      document.getElementById('vspincode').value = '';
      document.getElementById('vscountry').value = '';
      document.getElementById('vsphone').value = '';
      document.getElementById('vsfax').value = '';
    }
  }



  function address(){
    var chkbtn = document.getElementById('voka');
    if (chkbtn.checked == true) {
      document.getElementById('csstreet').value = document.getElementById('cstreet').value;
      document.getElementById('cscity').value = document.getElementById('ccity').value;
      document.getElementById('cspincode').value = document.getElementById('cpincode').value;
      document.getElementById('cscountry').value = document.getElementById('ccountry').value;
      document.getElementById('csstate').value = document.getElementById('cstate').value;
      document.getElementById('csphone').value = document.getElementById('cphone').value;
      document.getElementById('csfax').value = document.getElementById('cfax').value;
    } 
    else {
      document.getElementById('csstreet').value = '';
      document.getElementById('cscity').value = '';
      document.getElementById('csstate').value = '';
      document.getElementById('cspincode').value = '';
      document.getElementById('cscountry').value = '';
      document.getElementById('csphone').value = '';
      document.getElementById('csfax').value = '';
    }
  }
//------customer create 

$(document).on("click","#customersave",function(){
  if ($('input[name="radioCust"]:checked').val() == 'Business'){

    itemtype = $('#business').val();
  }
  else{
    itemtype = $('#individual').val();
  }

  if ($('input[name="radioOption2"]:checked').val() == 'Taxable'){
    inte = $('#item-tax3').val();
    
  }
  else{
    inte = $('#item-tax4').val();
  }


  $.ajax({
    
    type : 'POST',
    url:"{% url 'purchase_customer' %}",

    data:{
        tax:inte,
        itemtype:itemtype,
        title : $("#ctitle").val(),
        firstname : $("#cfname").val(),
        lastname : $("#clname").val(),
        company_name : $("#ccompany").val(),
        display_name : $('#cdisplayname').text(),
        email : $("#cemail").val(),
        website :$("#cwsite").val(),
        work_mobile :$("#cw_mobile").val(),
        pers_mobile :$("#cp_mobile").val(),
        skype :$("#cskype").val(),
        facebook :$("#facebook").val(),
        twitter :$("#twitter").val(),
        desg :$("#c_desg").val(),
        dpt :$("#c_dpt").val(),
        gsttype :$("#c_gsttype").val(),
        gstin :$("#c_gstin").val(),
        panno : $("#c_pan").val(),
        placesupply :$("#placesupply").val(),
        currency : $("#c_curn").val(),
        openingbalance : $("#c_open").val(),
        paymentterms : $("#c_terms").val(),
        street : $("#cstreet").val(),
        city : $("#ccity").val(),
        state : $("#cstate").val(),
        pincode : $("#cpincode").val(),
        fax : $("#cfax").val(),
        phone : $("#cphone").val(),
        country : $("#ccountry").val(),
        shipstreet : $("csstreet").val(),
        shipcity : $("#cscity").val(),
        shipstate : $("#csstate").val(),
        shippincode : $("#cspincode").val(),
        shipcountry : $("#cscountry").val(),
        shipfax : $("#csfax").val(),
        shipphone : $("#csphone").val(),
        radioCust: $("input[name='radioCust']:checked").val(),
        csrfmiddlewaretoken: '{{ csrf_token }}',
      },
      
      success: function(response) {
        document.getElementById("modalCustomer").reset();
        

        reloadcustomer();
        
      },
  });        
});

function reloadcustomer() {

  $.ajax({
    url: "{% url 'customer_dropdown' %}",
    type: "GET",
    dataType: "json",
    data: $(this).serialize(),
    csrfmiddlewaretoken: '{{ csrf_token }}',

    success: function(data) {
      var dropdow = $('#custom');
      dropdow.empty();
      $.each(data, function(key, value) {
          dropdow.append($('<option></option>').attr('value', key).text(value).val(value));
      });
    },
    error: function(xhr, status, error) {
    console.error(xhr.responseText);
    }
  });
}


  //---------modal vendor-----

      $("#vendorSave").on("click", function (e) {
        console.log("submit")
        e.preventDefault(); // Prevent the default form submission

        $.ajax({
          type: "POST",
          url: $("#modalVendor").attr("action"), // Get the URL from the form's action attribute
          data: $("#modalVendor").serialize(), // Serialize the form data
          dataType: "json",

    
      success: function(response) {
        console.log(response);
        console.log("successsssssssssssss");
        document.getElementById("modalVendor").reset();
        reloadVendor();
      },
  });        
});

function reloadVendor() {
  $.ajax({
    url: "{% url 'vendor_credit_dropdown' %}",
    type: "GET",
    dataType: "json",
    data: $(this).serialize(),
    csrfmiddlewaretoken: '{{ csrf_token }}',

    success: function(data) {
      var dropdown = $('#vendor');
      dropdown.empty();
      $.each(data, function(key, value) {
          dropdown.append($('<option></option>').attr('value', key).text(value[0]+" " +value[1] + ' ' + value[2]).val(value[1] + ' ' + value[2]+ ' ' +value[3]));
      });
    },
    error: function(xhr, status, error) {
    console.error(xhr.responseText);
    }
  });
}

//--------payment terms modal-----------

$(document).on("click","#paySave",function(){
  $.ajax({
    
    type : 'POST',
    url:"{% url 'vendor_credits_pay' %}",

    data:{
        name : $("#term_name").val(),
        days : $("#term_days").val(),
        
        csrfmiddlewaretoken: '{{ csrf_token }}'
        
      },
    
      success: function(response) {
        document.getElementById("modalPayment").reset();
        reloadPayment();
      },
  });        
});

function reloadPayment() {

  $.ajax({
    url: "{% url 'vendor_credits_pay_dropdown' %}",
    type: "GET",
    dataType: "json",
    data: $(this).serialize(),
    csrfmiddlewaretoken: '{{ csrf_token }}',

    success: function(data) {
      var dropdown = $('#terms');
      dropdown.empty();
      var drpv = $('#v_terms');
      drpv.empty();
      $.each(data, function(key, value) {
          dropdown.append($('<option></option>').attr('value', key).text(value).val(value));
          drpv.append($('<option></option>').attr('value', key).text(value).val(value));
      });
    },
    error: function(xhr, status, error) {
    console.error(xhr.responseText);
    }
  });
}


// unit modal


$(document).on("click","#unitSave",function(){
  $.ajax({
    
    type : 'POST',
    url:"{% url 'vendor_credits_unit' %}",

    data:{
        unit : $("#unit").val(),      
        csrfmiddlewaretoken: '{{ csrf_token }}'
        
      },
    
      success: function(response) {
        document.getElementById("modalUnit").reset();
        reloadUnit();
      },
  });        
});


function reloadUnit() {

  $.ajax({
    url: "{% url 'vendor_credits_unit_dropdown' %}",
    type: "GET",
    dataType: "json",
    data: $(this).serialize(),
    csrfmiddlewaretoken: '{{ csrf_token }}',

    success: function(data) {
      var dropdown = $('#item_units');
      dropdown.empty();

      $.each(data, function(key, value) {
          dropdown.append($('<option></option>').attr('value', key).text(value).val(value));
      });
    },
    error: function(xhr, status, error) {
    console.error(xhr.responseText);
    }
  });
}


// item modal

$(document).ready(function() {
  $("#item-tax1").click(function() {
  //  console.log($("#item_units").val().split(' ')[0]);
    $(".inter-intra").removeClass('d-none');
    $(".inter-intra").addClass('d-flex');
  });

  $("#item-tax2").click(function() {

    $(".inter-intra").removeClass('d-flex');
    $(".inter-intra").addClass("d-none");
  });
});

$(document).ready(function() {
  $("#item-tax3").click(function() {
  //  console.log($("#item_units").val().split(' ')[0]);
    $(".inter-intra").removeClass('d-none');
    $(".inter-intra").addClass('d-flex');
  });

  $("#item-tax4").click(function() {

    $(".inter-intra").removeClass('d-flex');
    $(".inter-intra").addClass("d-none");
  });
});

$(document).on("click","#itemSave",function(){

  if ($('input[name="radioOption"]:checked').val() == 'Goods'){

      itemtype = $('#item_type1').val();
    }
  else{
    itemtype = $('#item_type2').val();
  }

  if ($('input[name="radioOption1"]:checked').val() == 'Taxable'){
      inter = $('#inter').val();
      intra = $('#intra').val();
    }
  else{
    inter = 0;
    intra = 0;
  }

  
  $.ajax({
    
    type : 'POST',
    url:"{% url 'vendor_credit_item' %}",
    
    data:{
        type : itemtype,
        name : $("#item_name").val(),
        hsn : $("#hsn").val(),

        unit : $("#item_units").val(),
        inter : inter,
        intra : intra,
        sell_price : $("#sell_price").val(),
        cost_price : $("#cost_price").val(),
        sell_acc : $("#sell_acc").val(),
        cost_acc : $("#cost_acc").val(),
        sell_desc : $("#sell_desc").val(),
        cost_desc : $("#cost_desc").val(),
        
        csrfmiddlewaretoken: '{{ csrf_token }}'
        
      },
    
      success: function(response) {
        document.getElementById("modalItem").reset();
        reloadItem();
      },
  });        
});


function reloadItem() {
  $.ajax({
    url: "{% url 'vendor_credit_item_dropdown' %}",
    type: "GET",
    dataType: "json",
    data: $(this).serialize(),
    csrfmiddlewaretoken: '{{ csrf_token }}',

    success: function(data) {
      var dropdown = $('.itm');
      dropdown.empty();

      $.each(data, function(key, value) {
          dropdown.append($('<option></option>').attr('value', key).text(value).val(value));
      });
    },
    error: function(xhr, status, error) {
    console.error(xhr.responseText);
    }
  });
}

// account modal

$(document).on("click","#accountSave",function(){

  $.ajax({
    
    type : 'POST',
    url:"{% url 'vendor_credits_account' %}",
    
    data:{
        actype : $("#acct_type").val(),
        acname : $("#acct_name").val(),
     
        csrfmiddlewaretoken: '{{ csrf_token }}'
        
      },
    
      success: function(response) {
        document.getElementById("modalAccount").reset();
        reloadAccount();
      },
  });        
});


function reloadAccount() {
  $.ajax({
    url: "{% url 'vendor_credits_account_dropdown' %}",
    type: "GET",
    dataType: "json",
    data: $(this).serialize(),
    csrfmiddlewaretoken: '{{ csrf_token }}',

    success: function(data) {
      var dropdown = $('.acnt');
      dropdown.empty();

      $.each(data, function(key, value) {
          dropdown.append($('<option></option>').attr('value', key).text(value).val(value));
      });
    },
    error: function(xhr, status, error) {
    console.error(xhr.responseText);
    }
  });
}

</script>

<script>
var rowCount = 1;
$(document).ready(function () {
  // Counter for row IDs

  // Function to calculate the row amount
  function calculateRowAmount(row) {
    var qty = parseFloat(row.find('.qty').val());
    var rate = parseFloat(row.find('.rate').val());
    var tax = parseFloat(row.find('.tax').val());
    var discount = parseFloat(row.find('.discount').val());

    var rowAmount = (qty * rate) - discount;
    var taxAmount = (rowAmount * tax) / 100;

    row.find('.amount').val(rowAmount.toFixed(2));
    row.find('.taxamount').val(taxAmount.toFixed(2));
    
    return rowAmount;
    calculateTaxAmount();
  }

  // Function to calculate the subtotal
  function calculateSubtotal() {
    var subtotal = 0;
    $('#item_table tbody tr').each(function () {
      subtotal += calculateRowAmount($(this));
    });
    $('#subtotal').val(subtotal.toFixed(2));
  }

// Function to calculate the grand total
function calculateGrandTotal() {
  var grandTotal = 0;
  var totalTaxAmount = 0;

  $('#item_table tbody tr').each(function () {
    var rowAmount = calculateRowAmount($(this));
    grandTotal += rowAmount;
    var taxAmount = parseFloat($(this).find('.taxamount').val());
    grandTotal += taxAmount;
    totalTaxAmount += taxAmount;
  });
  var shippingCharges = parseFloat($('#shipping').val());
  grandTotal += shippingCharges;

  $('#grandtotal').val(grandTotal.toFixed(2));
  $('#total_taxamount').val(totalTaxAmount.toFixed(2));

  var paid = parseFloat($('#paid').val());
        var bal = grandTotal- paid
        $('#balance').val(bal.toFixed(2));
}

  $('#item_table').on('change', '.tax', function () {
    var row = $(this).closest('tr');
    calculateRowAmount(row);
    calculateSubtotal();
    calculateGrandTotal();
  });

  $('#add-row').click(function () {
    rowCount++; // Increment row counter
    var newRow = `
      <tr id='row${rowCount}'>
        <td class="text-center">${rowCount}</td>
        <td style="width: 9%;">
          <div>
            <select class='form-control bg-light text-dark  border-0 item_select itm' name='item[]' id='item${rowCount}'>
              <option value=" " selected disabled>Select Item</option>
              {% for i in item %}
                <option value="{{i.Name}}">{{ i.Name }}</option>
              {% endfor %}
            </select>
          </div>
        </td>
        
        <td style="width: 14%;" class='text-right'>
          <input type='number' id='hsn${rowCount}' class='text-right bg-light text-dark hsn form-control px-0' name='hsn[]'>
        </td>

        
        <td style="width: 9%;" class='text-right'>
          <input type='number' id='qty${rowCount}' class='text-right bg-light text-dark qty form-control' name='quantity[]' value='0'>
          <input type='number' id='maxqty${rowCount}'
                          class=' text-right maxqty form-control bg-light text-dark' name='maxqty[]'
                          value='0' style="display: none;">
          </td>
        
        <td style="width: 12%;" class='text-right'>
          <input type='number' id='rate${rowCount}' class='text-right bg-light text-dark rate form-control px-0' name='rate[]' value='0'>
        </td>
        
        <td style="width: 9%;" class='text-right'>
          <input type='number' id='discount${rowCount}' class='text-right bg-light text-dark discount form-control' name='discount[]' value='0'>
        </td>
        
        <td style="width: 14%;" class='text-right'>
          <select name='tax[]'  id='tax${rowCount}' class='form-control bg-light text-dark text-right border-0 tax px-0' onclick=' toggleDateInput()'>
            <optgroup class="text-center" label="GST">
                            <option value="0">0% GST(0%)</option>
                            <option value="3">3.0% GST(3%)</option>
                            <option value="5">5.0% GST(5%)</option>
                            <option value="12">12.0% GST(12%)</option>
                            <option value="18">18.0% GST(18%)</option>
                            <option value="28">28.0% GST(28%)</option>
                          </optgroup>
                          <optgroup  class="text-center" label="IGST">
                           
                            <option value="0">0% IGST(0%)</option>
                            <option value="3">3.0% IGST(3%)</option>
                            <option value="5">5.0% IGST(5%)</option>
                            <option value="12">12.0% IGST(12%)</option>
                            <option value="18">18.0% IGST(18%)</option>
                            <option value="28">28.0% IGST(28%)</option>             
                            </optgroup>
          </select>
        </td>
        
        <td style="display: none;">
          <input type="text" name='taxamount' id="taxamount${rowCount}" class="form-control bg-light text-dark taxamount" />
        </td>
        
        <td style="width: 25%;" class='text-right'>
          <input type='number' id='amount${rowCount}' class='text-right bg-light text-dark form-control amount' name='amount[]' value='0.00'>
        </td>
        
        <td class='text-center'>
  <button type='button' id='del_btn${rowCount}' class='btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-row' style='width:30px'>X</button>
  <button type='button' class='btn btn-transparent text-primary btn-sm btn-outline-primary rounded-circle clone-row' data-row='${rowCount}' style='width:30px'><i class="fa fa-clone"></i></button>
</td>

      </tr>
    `;
  $('#item_table tbody').append(newRow);
    toggleDateInput();
    calculateSubtotal();
    calculateGrandTotal();
  });
  $('#item_table').on('click', '.delete-row', function () {
    $(this).closest('tr').remove();
    calculateSubtotal();
    calculateGrandTotal();
    calculateTaxAmount();
  });
  $('#srcofsupply').on('change', function () {
  var row = $(this).closest('tr');
  calculateRowAmount(row);
  calculateSubtotal();
  calculateGrandTotal();
  toggleDateInput();
  calculateTaxAmount();

  // Calculate total tax amount and its IGST amount
  var totalTaxAmount = 0;
  var totalIGSTAmount = 0;

  $('#item_table tbody tr').each(function () {
    var tax = $(this).find('.tax').val();
    var amount = $(this).find('.amount').val();

    var taxAmount = amount * (tax / 100);
    totalTaxAmount += taxAmount;

    if (tax.startsWith('IGST')) {
      totalIGSTAmount += taxAmount;
    }
  });

  // Update the total tax amount and its IGST amount in the UI
  $('#total_taxamount').val(totalTaxAmount.toFixed(2));
  $('#total_igstamount').val(totalIGSTAmount.toFixed(2));
});

  $(document).ready(function() {
    var row = $(this).closest('tr');
    calculateRowAmount(row);
    calculateSubtotal();
    calculateGrandTotal();
    toggleDateInput();
    calculateTaxAmount();
});
  // Input change event for quantity, rate, and discount
  $('#item_table').on('input', '.qty, .rate, .discount,.tax', function () {
    var row = $(this).closest('tr');
    var qty = parseFloat(row.find('.qty').val());
    var maxqty = parseFloat(row.find('.maxqty').val());

    if (qty > maxqty && maxqty!='') {
        alert("Quantity exceeds maximum quantity!");
        // Optionally, you can reset the quantity input
        row.find('.qty').val('');
    } 
 
        calculateRowAmount(row);
        calculateSubtotal();
        calculateGrandTotal();
        toggleDateInput();
        calculateTaxAmount();
    
  });

  $('#shipping').on('input', function () {
    var shippingAmount = parseFloat($(this).val());
    $('#shipping_charge').val(shippingAmount.toFixed(2));
    calculateGrandTotal();
  });
  $(document).on("input", "#paid", function () {

if ($(this).val() != '') {
    var bal = parseFloat($("#grandtotal").val()) - parseFloat($("#paid").val())
    $('#balance').val(bal.toFixed(2));
}
else {
    var bal = parseFloat($("#grandtotal").val()) - 0
    $('#balance').val(bal.toFixed(2));
}

});


  // Add an event listener to the fields in the item table
$('#item_table').on('click', '.item_select, .acnt, .rate, .qty, .tax, .discount', function () {
  var row = $(this).closest('tr');
  var taxElement = row.find('.tax');

  var state = $('#srcofsupply').val();
  var stateName = state.split('-')[1].trim();

  if (stateName === "{{company.state}}") {
    taxElement.find('optgroup[label="GST"]').show();
    taxElement.find('optgroup[label="IGST"]').hide();
  } else {
    taxElement.find('optgroup[label="GST"]').hide();
    taxElement.find('optgroup[label="IGST"]').show();
  }
});

// Event handler for clone button
$('#item_table').on('click', '.clone-row', function () {
  var row = $(this).closest('tr');
  var clonedRow = row.clone(); // Clone the current row
  var newRowId = 'row' + rowCount; // Generate a new ID for the cloned row
  clonedRow.attr('id', newRowId); // Set the new ID for the cloned row

  // Clone the options for tax, account, and item
  var currentItem = row.find('.item_select').val();
  clonedRow.find('.item_select').val(currentItem);
  var currentAccount = row.find('.acnt').val();
  clonedRow.find('.acnt').val(currentAccount);
  var currentTax = row.find('.tax').val();
  clonedRow.find('.tax').val(currentTax);

  rowCount++; // Increment row counter

  $('#item_table tbody').append(clonedRow);
  var row = $(this).closest('tr');
  calculateRowAmount(row);
  calculateSubtotal();
  calculateGrandTotal();
  toggleDateInput();
  calculateTaxAmount();
  toggleDateInput();
});


       

});
function calculateTaxAmount() {
            var state = $('#srcofsupply').val();
            var stateName = state.split('-')[1].trim();
        
        var subtotal = parseFloat(document.getElementById("subtotal").value);
        var shipping = parseFloat(document.getElementById("shipping").value);
        var tax = parseFloat(document.getElementById("total_taxamount").value);
        
        var tax_rate = 0.0; // Default tax rate for IGST
        if (stateName === '{{company.state}}') {
            tax_rate =tax; // Tax rate for CGST/SGST
        }
        tax_rate =tax;
        var total_taxamount = tax_rate;

        var cgst = 0.00;
        var sgst = 0.00;
        var igst = 0.00;

        if (stateName === '{{company.state}}') {
            cgst = total_taxamount / 2;
            sgst = total_taxamount / 2;
        } else {
            igst = tax;
        }

        document.getElementById("cgst").value = cgst.toFixed(2);
        document.getElementById("sgst").value = sgst.toFixed(2);
        document.getElementById("igst").value = igst.toFixed(2);

        if (stateName === '{{company.state}}') {
            document.getElementById("tr_igst").style.display = "none";
            document.getElementById("tr_cgst").style.display = "";
            document.getElementById("tr_sgst").style.display = "";
        } else {
            document.getElementById("tr_igst").style.display = "";
            document.getElementById("tr_cgst").style.display = "none";
            document.getElementById("tr_sgst").style.display = "none";
        }

        document.getElementById("total_taxamount").value = total_taxamount.toFixed(2);
        var grandtotal = subtotal + total_taxamount + shipping;
        document.getElementById("grandtotal").value = grandtotal.toFixed(2);


        var paid = parseFloat(document.getElementById("paid").value);
        var bal = grandtotal- paid
        document.getElementById("balance").value = bal.toFixed(2);
    }

    // Call the function initially on page load
    

    // Add event listeners to update tax amounts when subtotal or shipping changes
    document.getElementById("subtotal").addEventListener("input", calculateTaxAmount);
    document.getElementById("shipping").addEventListener("input", calculateTaxAmount);
    

function toggleDateInput() {
      var checkbox = document.getElementById("srcofsupply");
      var vale=checkbox.value;
      
      for (var i = 1; i <= rowCount; i++) {
        var taxElement = $('#tax' + i);

        if (vale === "[KL] Kerala") {
            taxElement.find('optgroup[label="GST"]').show();
            taxElement.find('optgroup[label="IGST"]').hide();
        } else {
            taxElement.find('optgroup[label="GST"]').hide();
            taxElement.find('optgroup[label="IGST"]').show();
        }
    }
  }

  function test(taxamount) {
        console.log('test333');
        console.log(taxamount)
        d = 0;
        var checkbox = document.getElementById("srcofsupply");
        var vale=checkbox.value;
        console.log(pos)
        console.log('state')
        console.log(state)
        console.log('state')
        console.log('----------')
        if ( vale === "[KL] Kerala") {
            console.log(pos);
            console.log(state);
            console.log(taxamount);
            gst = taxamount / 2;
            console.log(gst);
            $('#cgst').val(parseFloat(gst.toFixed(2)));
            $('#sgst').val(parseFloat(gst.toFixed(2)));
            $('#igst').val(parseFloat(d.toFixed(2)));
            
            // document.getElementById('tr_cgst').style= ('display: flex');
            
            // document.getElementById('tr_sgst').style= ('display: flex');
            // document.getElementById('tr_igst').style= ('display: none');

           
        }
        else{
            gst = taxamount ;
            console.log(gst);
            $('#cgst').val(parseFloat(d.toFixed(2)));
            $('#sgst').val(parseFloat(d.toFixed(2)));
            $('#igst').val(parseFloat(gst.toFixed(2)));
        }
        var checkbox = document.getElementById("srcofsupply");
        var vale=checkbox.value;
        var pos= "[KL]-Kerala"
        if (vale==pos){

        }

        if (vale !=  "[KL]-Kerala") {
            console.log(pos);
            console.log(state);
            document.getElementById('tr_cgst').style=('display: none');
            document.getElementById('tr_sgst').style= ('display: none');
            document.getElementById('tr_igst').style= ('display: block');
        }
        else{
            document.getElementById('tr_cgst').style=('display: block');
            document.getElementById('tr_sgst').style= ('display: block');
            document.getElementById('tr_igst').style= ('display: none');
        }
    }

</script>

<script>
  $(document).ready(function () {


    $(document).on('change', '.item_select', function () {
    console.log("-------------------------");

    // Find the closest row of the changed dropdown
    var $closestRow = $(this).closest('tr');
    var n = $closestRow.attr('id').replace('row', '');
    console.log("Row number:", n);

    // Get the selected customer value
    var customer = $('#customer_sel').val();

    // Send AJAX request to fetch data based on the selected item and customer
    $.ajax({
        type: "GET",
        url: "{% url 'itemdata_vendor_credit' %}",
        data: {
            id: $(this).val(),
            cust: customer
        },
        success: function (response) {
            console.log(response);

            // Extract data from the response
            var data = response.rate;
            var data1 = response.gst;
            var data2 = response.igst;
            var data5 = response.hsn;

            // Set values to elements in the nth row
            $closestRow.find('.rate').val(data);
            $closestRow.find('.hsn').val(data5);

            // Extract state name from source of supply
            var state = $('#srcofsupply').val();
            var stateName = state.split('-')[1].trim();

            // Set tax value based on the state name
            var taxValue = (stateName == '{{ company.state }}') ? data1 : data2;
            $closestRow.find('.tax').val(taxValue);
        }
    });
    var current_item = $closestRow.find('.itm').val();
    var prevRows = $closestRow.prevAll(); // Get previous rows

    // Iterate over previous rows to check for the same item selection
    prevRows.each(function () {
        var prevRow = $(this);
        var prev_item = prevRow.find('.itm').val();

        // Check if the current item matches any previous item
        if (current_item && prev_item && current_item === prev_item) {
            alert("You have selected the same item in the previous row.");
            // Optionally, you can reset the item selection
            $closestRow.find('.itm').val('');
                $closestRow.find('.maxqty').val('');
                $closestRow.find('.hsn').val('');
                $closestRow.find('.rate').val('');
                $closestRow.find('.tax').val('');

            return false; // Exit the loop once a match is found
        }
      
    });
});
      // console.log('pos:'+place_of_supply);
      

     


  });
</script>
{% endblock %}